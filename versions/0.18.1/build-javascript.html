<!DOCTYPE html>
<html lang="en" itemscope itemtype="https://schema.org/WebPage">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Building JavaScript Outputs - Bazel</title>

    <link rel="canonical" href="/versions/0.18.1/build-javascript.html">

    <!-- Webfont -->
    <link href="//fonts.googleapis.com/css?family=RobotoDraft:300,400,500,700|Source+Code+Pro:400,500,700" rel="stylesheet">

    <link rel="shortcut icon" type="image/png" href="/images/favicon.ico">

    <!-- Bootstrap -->
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/css/font-awesome.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Custom stylesheet -->
    <link rel="stylesheet" type="text/css" href="/css/main.css" />

    <!-- metadata -->
    <meta name="og:title" content="Building JavaScript Outputs"/>
    <meta name="og:image" content="/images/bazel-og-image.png"/>

    <!-- google search console verification -->
    <meta name="google-site-verification" content="ftWLOiP2hnDW4Cw3LUGEaXU83RVIpiyxwaXFFhoakzs" />
  </head>

  <body>
        <nav id="common-nav" class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="https://www.bazel.build/">
            <img class="navbar-logo" src="/images/bazel-navbar.svg">
          </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="https://github.com/bazelbuild/bazel">GitHub</a></li>
          </ul>
          <form class="navbar-form navbar-right" action="/search.html" id="cse-search-box">
            <div class="form-group">
              <input type="hidden" name="cx" value="012346921571893344015:xv_nfgpzbu4">
              <input type="hidden" name="cof" value="FORID:10">
              <input type="hidden" name="ie" value="UTF-8">
              <input type="search" name="q" class="form-control input-sm" placeholder="Search">
            </div>
          </form>
          <ul class="nav navbar-nav navbar-right">
            <li>
              <a href="/">Documentation</a>
            </li>
            <li>
              <a href="https://www.bazel.build/contributing.html">Contribute</a>
            </li>
            <li>
              <a href="https://blog.bazel.build">Blog</a>
            </li>
            <li><a href="https://twitter.com/bazelbuild" class="nav-icon"><i class="fa fa-twitter"></i></a></li>
            <li><a href="http://stackoverflow.com/questions/tagged/bazel" class="nav-icon"><i class="fa fa-stack-overflow"></i></a></li>
          </ul>
        </div><!-- /.navbar-collapse -->
      </div><!-- /.container-fluid -->
    </nav>


    <div class="page-title-bar">
      <div class="container">
        <h1>Documentation</h1>
      </div>
    </div>

    <div class="container vpad">
      <div class="row">
        <div class="col-md-3">
          <a class="btn btn-default btn-lg btn-block sidebar-toggle"
              data-toggle="collapse" href="#sidebar-nav" aria-expanded="false"
              aria-controls="sidebar-nav">
            <i class="glyphicon glyphicon-menu-hamburger"></i> Navigation
          </a>
          <nav class="sidebar collapse" id="sidebar-nav">
           <h3>Home</h3>
            <ul class="sidebar-nav">
              <li><a href="/versions/master/bazel-overview.html">Bazel Overview</a></li>
              <li><a href="/versions/master/bazel-vision.html">Bazel Vision</a></li>
              <li><a href="/versions/master/getting-started.html">Getting Started</a></li>
              <li><a href="/versions/master/skylark/backward-compatibility.html">Backward Compatibility</a></li>
            </ul>

           <h3>Using Bazel</h3>
            <ul class="sidebar-nav">

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#installing-menu" aria-expanded="false"
                    aria-controls="installing-menu">
                  Installing Bazel<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="installing-menu">
                   <li><a href="/versions/master/install.html">Installation Overview</a></li>
                   <li><a href="/versions/master/install-ubuntu.html">Installing on Ubuntu</a></li>
                   <li><a href="/versions/master/install-redhat.html">Installing on Fedora/CentOS</a></li>
                   <li><a href="/versions/master/install-os-x.html">Installing on macOS</a></li>
                   <li><a href="/versions/master/install-windows.html">Installing on Windows</a></li>
                   <li><a href="/versions/master/install-compile-source.html">Compiling from Source</a></li>
                   <li><a href="/versions/master/completion.html">Command-Line Completion</a></li>
                   <li><a href="/versions/master/ide.html">Integrating with IDEs</a></li>
                 </ul>
                </li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#tutorials-menu" aria-expanded="false"
                    aria-controls="tutorials-menu">
                  Tutorials<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="tutorials-menu">
                   <li><a href="/versions/master/tutorial/java.html">Building a Java Project</a></li>
                   <li><a href="/versions/master/tutorial/cpp.html">Building a C++ Project</a></li>
                   <li><a href="/versions/master/tutorial/android-app.html">Building an Android App</a></li>
                   <li><a href="/versions/master/tutorial/ios-app.html">Building an iOS App</a></li>
                   <li><a href="/versions/master/skylark/tutorial-sharing-variables.html">Sharing Variables</a></li>
                   <li><a href="/versions/master/skylark/tutorial-creating-a-macro.html">Creating a Macro</a></li>
                 </ul>
              </li>

              <li><a href="/versions/master/build-ref.html">Bazel Concepts</a></li>
              <li><a href="/versions/master/guide.html">User's Guide</a></li>
              <li><a href="/versions/master/external.html">External Dependencies</a></li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#query-menu" aria-expanded="false"
                    aria-controls="query-menu">
                  Queries<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="query-menu">
                  <li><a href="/versions/master/query-how-to.html">Bazel query</a></li>
                  <li><a href="/versions/master/cquery.html">Bazel cquery</a></li>
                  <li><a href="/versions/master/user-manual.html#aquery">Bazel aquery</a></li>
                  <li><a href="/versions/master/query.html">Query Language</a></li>
                </ul>
              </li>

              <li><a href="/versions/master/configurable-attributes.html">Configurable Attributes</a></li>
              <li><a href="/versions/master/best-practices.html">Best Practices</a></li>
              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#remote-execution-menu" aria-expanded="false"
                    aria-controls="remote-execution-menu">
                  Remote Execution<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="remote-execution-menu">
                   <li><a href="/versions/master/remote-execution.html">Remote Execution Overview</a></li>
                   <li><a href="/versions/master/remote-execution-rules.html">Guidelines for Remote Execution</a></li>
                   <li>
                      <a class="sidebar-nav-heading" data-toggle="collapse"
                          href="#troubleshoot-remote-execution-menu" aria-expanded="false"
                          aria-controls="troubleshoot-remote-execution-menu">
                        Troubleshooting Remote Execution<span class="caret"></span>
                      </a>
                      <ul class="collapse sidebar-nav sidebar-submenu" id="troubleshoot-remote-execution-menu">
                         <li><a href="/versions/master/remote-execution-sandbox.html">Troubleshooting Remote Execution with Bazel Sandbox</a></li>
                         <li><a href="/versions/master/workspace-log.html">Finding non-hermetic behavior in WORKSPACE rules</a></li>
                      </ul>
                  </li>
                   <li><a href="/versions/master/remote-execution-ci.html">Configuring Bazel CI for Remote Execution Rule Testing</a></li>
                 </ul>
              </li>

              <li><a href="/versions/master/remote-caching.html">Remote Caching</a></li>
             </ul>

           <h3>Rules</h3>
           <ul class="sidebar-nav">
             <li><a href="/versions/master/be/overview.html">Build Encyclopedia</a></li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#android-menu" aria-expanded="false"
                    aria-controls="android-menu">
                  Android<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="android-menu">
                  <li><a href="/versions/master/bazel-and-android.html">Android Resources</a></li>
                  <li><a href="/versions/master/mobile-install.html">Using mobile-install</a></li>
                  <li><a href="/versions/master/android-instrumentation-test.html">Android Instrumentation Tests</a></li>
                  <li><a href="/versions/master/android-ndk.html">Android NDK</a></li>
                  <li><a href="https://plugins.jetbrains.com/plugin/9185-bazel">Android Studio Plugin</a></li>
                </ul>
              </li>

               <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#apple-menu" aria-expanded="false"
                    aria-controls="apple-menu">
                  Apple<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="apple-menu">
                  <li><a href="/versions/master/bazel-and-apple.html">Apple Resources</a></li>
                  <li><a href="/versions/master/migrate-xcode.html">Migrating from Xcode</a></li>
                  <li><a href="/versions/master/migrate-cocoapods.html">Converting CocoaPods</a></li>
                </ul>
              </li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#cpp-menu" aria-expanded="false"
                    aria-controls="cpp-menu">
                  C++<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="cpp-menu">
                  <li><a href="/versions/master/bazel-and-cpp.html">C++ Resources</a></li>
                  <li><a href="/versions/master/cpp-use-cases.html">C++ Use Cases</a></li>
                  <li><a href="/versions/master/crosstool-reference.html">Understanding CROSSTOOL</a></li>
                  <li><a href="/versions/master/tutorial/crosstool.html">Tutorial: CROSSTOOL</a></li>
                </ul>
              </li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#java-menu" aria-expanded="false"
                    aria-controls="java-menu">
                  Java<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="java-menu">
                  <li><a href="/versions/master/bazel-and-java.html">Java Resources</a></li>
                  <li><a href="/versions/master/migrate-maven.html">Migrating from Maven</a></li>
                  <li><a href="/versions/master/generate-workspace.html">Converting Maven Dependencies</a></li>
                </ul>
              </li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#javascript-menu" aria-expanded="false"
                    aria-controls="javascript-menu">
                  JavaScript<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="javascript-menu">
                  <li><a href="/versions/master/bazel-and-javascript.html">JavaScript Resources</a></li>
                  <li><a href="/versions/master/build-javascript.html">Building JavaScript</a></li>
                </ul>
              </li>

           </ul>

           <h3>Reference</h3>
           <ul class="sidebar-nav">
             <li><a href="/versions/master/user-manual.html">Commands and Options</a></li>
             <li><a href="/versions/master/skylark/build-style.html">BUILD Style Guide</a></li>
             <li><a href="/versions/master/command-line-reference.html">Command Line Reference</a></li>
             <li><a href="/versions/master/test-encyclopedia.html">Writing Tests</a></li>
             <li><a href="/versions/master/build-event-protocol.html">Build Event Protocol</a></li>
             <li><a href="/versions/master/output_directories.html">Output Directory Layout</a></li>
             <li><a href="/versions/master/platforms.html">Platforms</a></li>
             <li><a href="/versions/master/toolchains.html">Toolchains</a></li>
           </ul>

            <h3>Extending Bazel</h3>
           <ul class="sidebar-nav">
              <li><a href="/versions/master/skylark/concepts.html">Extension Overview</a></li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#starlark-concepts" aria-expanded="false"
                    aria-controls="starlark-concepts">
                  Concepts<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="starlark-concepts">
                  <li><a href="/versions/master/skylark/macros.html">Macros</a></li>
                  <li><a href="/versions/master/skylark/rules.html">Rules</a></li>
                  <li><a href="/versions/master/skylark/depsets.html">Depsets</a></li>
                  <li><a href="/versions/master/skylark/aspects.html">Aspects</a></li>
                  <li><a href="/versions/master/skylark/repository_rules.html">Repository Rules</a></li>
                  <li><a href="/versions/master/skylark/faq.html">FAQ</a></li>
                </ul>
              </li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#starlark-practices" aria-expanded="false"
                    aria-controls="starlark-practices">
                  Best Practices<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="starlark-practices">
                  <li><a href="/versions/master/skylark/bzl-style.html">.bzl Style Guide</a></li>
                  <li><a href="/versions/master/skylark/testing.html">Testing</a></li>
                  <li><a href="https://skydoc.bazel.build" target="_blank">Documenting Rules</a></li>
                  <li><a href="/versions/master/skylark/skylint.html">Linter</a></li>
                  <li><a href="/versions/master/skylark/performance.html">Optimizing Performance</a></li>
                  <li><a href="/versions/master/skylark/deploying.html">Deploying Rules</a></li>
                </ul>
              </li>

              <li><a href="https://github.com/bazelbuild/examples/tree/master/rules">Examples</a></li>
              <li><a href="/versions/master/skylark/lib/skylark-overview.html">API Reference</a></li>
              <li><a href="/versions/master/skylark/language.html">Starlark Language</a></li>
            </ul>
          </nav>
        </div>

        <div class="col-md-9">
          <a id="gh-edit" class="gh-edit default-hidden"><i class="fa fa-pencil" aria-hidden="true"></i> Edit</a>
          <script>
            var versionDocsURLRegex = /\/versions\/[\w\.]+\/(.*)/;
            var ghDocsBazeURL = 'https://github.com/bazelbuild/bazel/tree/master/site/docs/';
            var editButton = document.getElementById('gh-edit');
            // if there is an edit button and we are not in the Build Encyclopedia
            if (editButton
                && window.location.pathname.match(versionDocsURLRegex)
                && window.location.pathname.lastIndexOf('/be/') == -1
                && window.location.pathname.lastIndexOf('/skylark/lib/') == -1) {
              var docFile = window.location.pathname.match(versionDocsURLRegex)[1];
              // some pages are not using markdown :(
              if (docFile !== 'user-manual.html'
                  && docFile !== 'build-ref.html'
                  && docFile !== 'query.html'
                  && docFile !== 'test-encyclopedia.html') {
                docFile = docFile.replace('html', 'md');
              }
              editButton.href = ghDocsBazeURL + docFile;
              editButton.style.visibility = 'visible';
            }
          </script>

          <!-- /versions/master/foo/bar -> ["master", "foo", "bar"] -->
          <!-- /versions/0.12.3/baz.md -> ["0.12.3", "baz.md"] -->
          

          <p>Documentation for Bazel 0.18.1</p>
          <select id="touchsplashmenu" onchange="location.href=this.value">
              <option value="">Choose a Bazel version</option>
              
              <option value="/versions/master/build-javascript.html">master</option>
              
              <option value="/versions/0.19.2/build-javascript.html">0.19.2</option>
              
              <option value="/versions/0.19.1/build-javascript.html">0.19.1</option>
              
              <option value="/versions/0.18.1/build-javascript.html">0.18.1</option>
              
              <option value="/versions/0.17.2/build-javascript.html">0.17.2</option>
              
              <option value="/versions/0.17.1/build-javascript.html">0.17.1</option>
              
          </select>

          <h1 id="building-javascript-outputs">Building JavaScript Outputs</h1>

<p>Bazel supports an incremental and customizable means of building and testing
JavaScript outputs from JavaScript, TypeScript, and Angular sources.</p>

<p><strong>Note:</strong> This document describes Bazel features and workflows that are useful,
but the Bazel team has not fully verified and does not officially support
these features and workflows.</p>

<h2 id="contents">Contents</h2>

<ul>
  <li><a href="#overview">Overview</a></li>
  <li><a href="#setting-up-your-environment">Setting up your environment</a>
    <ul>
      <li><a href="#step-1-installing-bazel">Step 1: Installing Bazel</a></li>
      <li><a href="#step-2-installing-ibazel">Step 2: Installing iBazel</a></li>
      <li><a href="#step-3-configuring-the-bazel-rc-file">Step 3: Configuring the <code class="highlighter-rouge">bazel.rc</code> file</a></li>
      <li><a href="#step-4-optional-setting-up-continuous-integration-ci">Step 4: (Optional) Setting up Continuous Integration (CI)</a></li>
    </ul>
  </li>
  <li><a href="#building-javascript">Building JavaScript inputs</a></li>
  <li><a href="#building-typescript">Building TypeScript inputs</a>
    <ul>
      <li><a href="#compiling-typescript-inputs-ts_library">Compiling TypeScript inputs (<code class="highlighter-rouge">ts_library</code>)</a></li>
      <li><a href="#running-a-development-server-ts_devserver">Running a development server (<code class="highlighter-rouge">ts_devserver</code>)</a></li>
      <li><a href="#testing-typescript-code-ts_web_test">Testing TypeScript code (<code class="highlighter-rouge">ts_web_test</code>)</a></li>
    </ul>
  </li>
  <li><a href="#building-angular-inputs">Building Angular inputs</a></li>
</ul>

<h2 id="overview">Overview</h2>

<p>Bazel rules for building JavaScript outputs are split into three layers, since
you can use JavaScript without TypeScript, and TypeScript without Angular.
This document assumes you are already familiar with Bazel and uses the
<a href="https://github.com/alexeagle/angular-bazel-example">Angular for Bazel sample project</a>
to illustrate the recommended configuration. You can use the sample project as a
starting point and add your own code to it to start building with Bazel.</p>

<p>If you’re new to Bazel, take a look at the <a href="https://docs.bazel.build/versions/master/getting-started.html">“Getting Started”</a>
material before proceeding.</p>

<h2 id="setting-up-your-environment">Setting up your environment</h2>

<p>To set up your environment for building JavaScript outputs with Bazel, do the
following:</p>

<h3 id="step-1-installing-bazel">Step 1: Installing Bazel</h3>

<p>If you have not already done so, <a href="https://docs.bazel.build/versions/master/install.html">Install Bazel</a>.</p>

<h3 id="step-2-installing-ibazel">Step 2: Installing iBazel</h3>

<p>iBazel, or iterative Bazel, is a “watchdog” version of Bazel that automatically
runs whenever your source files change. Use it to auto-run your tests and
auto-refresh the code served by the development server.</p>

<p><a href="https://github.com/bazelbuild/bazel-watcher">Install iBazel</a> globally using
your package manager of choice. The global installation is required so that
iBazel is in your PATH variable. Also install a specific version of iBazel into
your project so that your whole team updates together. For example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm install --save-dev @bazel/ibazel
npm install --global @bazel/ibazel
</code></pre></div></div>
<p>or</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yarn add -D @bazel/ibazel
yarn global add @bazel/ibazel
</code></pre></div></div>

<p>To use <code class="highlighter-rouge">ibazel</code>, simply replace <code class="highlighter-rouge">bazel</code> with <code class="highlighter-rouge">ibazel</code> in your Bazel commands.</p>

<h3 id="step-3-configuring-the-bazelrc-file">Step 3: Configuring the <code class="highlighter-rouge">bazel.rc</code> file</h3>

<p>Any Bazel build flag or option that can be placed on the command line can also
be set in the project’s <a href="https://docs.bazel.build/versions/master/user-manual.html#bazelrc"><code class="highlighter-rouge">bazel.rc</code> file</a>
so that it is applied every time Bazel builds or tests the project.</p>

<p>Based on how you want to share Bazel settings across your project and team(s),
you can use any combination of the following techniques:</p>

<ul>
  <li>
    <p><strong>To use the same Bazel settings for the project</strong>, create a <code class="highlighter-rouge">tools/bazel.rc</code>
file at the root of the Bazel workspace. Adding it to the workspace will
check the file into version control and propagate it to others working on
the project as well as the CI system.</p>
  </li>
  <li>
    <p><strong>To personalize Bazel settings for the project but not share them,</strong>
create a <code class="highlighter-rouge">.bazel.rc</code> file at the root of the project and add the file to
your <code class="highlighter-rouge">.gitignore</code> list.</p>
  </li>
  <li>
    <p><strong>To personalize Bazel settings for all of your projects on your
local machine,</strong> create a <code class="highlighter-rouge">.bazel.rc</code> file in your home directory.</p>
  </li>
</ul>

<p>Here’s an example <code class="highlighter-rouge">tools/bazel.rc</code> file to share with your team. Modify this
template as needed.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>###############################
# Directory structure         #
###############################

# Globally cache downloaded artifacts.
build --experimental_repository_cache=~/.bazel_cache/
test --experimental_repository_cache=~/.bazel_cache/
run --experimental_repository_cache=~/.bazel_cache/

# Don't create bazel-* symlinks in the WORKSPACE directory. These
# symlinks require .gitignore and may scare users. Instead, run
# `bazel info bazel-bin` to find out where the outputs are stored.
build --symlink_prefix=/

# Another good choice is to create a dist/ directory. Then you can
# use build --symlink_prefix=dist/ to get folders like dist/bin.
# Be aware that this setup will still create a bazel-out symlink in
# your project directory, which you may need to exclude from the
# editor's search path.

###############################
# Output                      #
###############################

# A more useful default output mode for bazel query, which
# prints "ng_module rule //foo:bar" instead of just "//foo:bar".
query --output=label_kind

# By default, failing tests don't print any output, it's logged to a
# file instead.

test --test_output=errors

# Show which actions are running under which workers and print all
# the actions running in parallel. This shows that Bazel runs on all
# cores of a CPU.
build --experimental_ui
test --experimental_ui

###############################
# Typescript / Angular / Sass #
###############################
# Make TypeScript and Angular compilation fast, by keeping a few
# copies of the compiler running as daemons, and cache SourceFile
# ASTs to reduce parse time.
build --strategy=TypeScriptCompile=worker --strategy=AngularTemplateCompile=worker

# Enable debugging tests with --config=debug
test:debug --test_arg=--node_options=--inspect-brk --test_output=streamed --test_strategy=exclusive --test_timeout=9999 --nocache_test_results
</code></pre></div></div>

<h3 id="step-4-optional-setting-up-continuous-integration-ci">Step 4: (Optional) Setting up Continuous Integration (CI)</h3>

<p>For building JavaScript outputs with Bazel in a CI setting, it’s useful to use a
container as the environment. The <a href="https://hub.docker.com/r/angular/ngcontainer/">ngcontainer Docker image</a>
is a ready-to-use environment you can use that makes your builds reproducible in
other environments, such as your local machine. This reproducibility is
especially convenient on CircleCI, which lets you choose a Docker image as the
environment for your build. See the example <a href="https://github.com/alexeagle/angular-bazel-example/blob/master/.circleci/config.yml">CircleCI configuration</a>
in the sample project to learn more.</p>

<p><strong>Tip:</strong> When building in a CI environment, add settings to your <code class="highlighter-rouge">bazel.rc</code> file
that are specific to CI using the <code class="highlighter-rouge">build:ci</code> and or <code class="highlighter-rouge">test:ci</code> prefixes. With
this configuration, you can enable those CI-specific options by simply adding
the <code class="highlighter-rouge">--config=ci</code> argument to your Bazel/iBazel commands.</p>

<h2 id="building-javascript">Building JavaScript</h2>

<p>Use the <code>[rules_nodejs](https://github.com/bazelbuild/rules_nodejs)</code>
rules to build NodeJS applications and execute JavaScript code within Bazel. You
can execute JavaScript tools in the Bazel toolchain, binary programs, or tests.
The NodeJS rules add the NodeJS runtime to your Bazel project.</p>

<p>Most notable NodeJS rules include:</p>

<ul>
  <li>
    <p><code class="highlighter-rouge">nodejs_binary</code> - builds an executable program based on JavaScript source
files and an entry point path relative to the output root. To provide extra
inputs to be read at runtime, put them in the data attribute.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">jasmine_node_test</code> - runs JavaScript spec files through the Jasmine test
framework. See the <a href="https://bazelbuild.github.io/rules_nodejs/">node_js API documentation</a>
for more information.</p>
  </li>
</ul>

<h2 id="building-typescript">Building TypeScript</h2>

<p>Use the <code>[rules_typescript](https://github.com/bazelbuild/rules_typescript)</code>
rules to build JavaScript outputs from TypeScript inputs.</p>

<p>To set up your Bazel project for building TypeScript inputs, do the following:</p>

<ol>
  <li>
    <p>Make Bazel aware of the TypeScript build rules by adding the following entry
to your <code class="highlighter-rouge">WORKSPACE</code> file:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http_archive(
    name = "build_bazel_rules_typescript",
    url = "https://github.com/bazelbuild/rules_typescript/archive/v0.13.0.zip",
    strip_prefix = "rules_typescript-0.13.0",
)

load("@build_bazel_rules_typescript//:defs.bzl", "ts_setup_workspace")

ts_setup_workspace()

</code></pre></div>    </div>
  </li>
  <li>
    <p>Add the <code class="highlighter-rouge">--strategy</code> settings to your <code class="highlighter-rouge">bazel.rc</code> file as shown in the
example <code class="highlighter-rouge">.bazel.rc</code> file in <a href="#step-3-configuring-the-bazel-rc-file">“Configuring the bazel.rc file”</a>.</p>
  </li>
</ol>

<h3 id="compiling-typescript-inputs-ts_library">Compiling TypeScript inputs (<code class="highlighter-rouge">ts_library</code>)</h3>

<p>The <code class="highlighter-rouge">ts_library</code> rule compiles one package of TypeScript code at a time. Each
library compiles independently using the <code class="highlighter-rouge">.d.ts</code> declaration files from its
dependencies. Thus, Bazel will only rebuild a package if the API the package
depends on changes.</p>

<p>The <code class="highlighter-rouge">ts_library </code>rule, by default, outputs a <code class="highlighter-rouge">.d.ts</code> file for each <code class="highlighter-rouge">.ts</code> source
file input into it, plus an ES5 (devmode) <code class="highlighter-rouge">.js</code> file to be used as inputs for
rule targets that depend on the current target, including transitively.</p>

<p><strong>Tip:</strong> You can try out the <code class="highlighter-rouge">ts_library</code> rule by running bazel build src in
the <a href="https://github.com/alexeagle/angular-bazel-example/wiki">sample project</a>.</p>

<p><strong>Note:</strong> We recommend standardizing your TypeScript settings into a single
<code class="highlighter-rouge">tsconfig.json</code> file or as few <code class="highlighter-rouge">tsconfig.json</code> files as possible.</p>

<p>Note the following:</p>

<ul>
  <li>
    <p>Bazel controls parts of the <code class="highlighter-rouge">tsconfig.json </code>file  that define locations of
input and output files, manage dependencies on typings, and produce
JavaScript output that’s readable by downstream tooling. Currently, this
format is unbundled UMD modules, wrapping noth named (non-anonymous) AMD
modules and <code class="highlighter-rouge">commonjs</code> modules.</p>
  </li>
  <li>
    <p>Bazel may introduce new requirements for your TypeScript code. For example,
Bazel uses the <code class="highlighter-rouge">-declarations</code> flag to produce <code class="highlighter-rouge">.d.ts</code> outputs required by
dependent rule targets; your code may require adjustment to not produce
errors when the <code class="highlighter-rouge">-declarations</code> flag is in use.</p>
  </li>
  <li>
    <p>If your TypeScript builds are slow, consider granularizing the affected rule
target(s) into smaller sub-targets and declaring dependencies between them
appropriately.</p>
  </li>
</ul>

<h3 id="running-a-development-server-ts_devserver">Running a development server (<code class="highlighter-rouge">ts_devserver</code>)</h3>

<p>The <code class="highlighter-rouge">ts_devserver</code> rule brings up a development server from your application
sources. It’s intended for use with the <code class="highlighter-rouge">ibazel run</code> command so that the server
picks up your code changes immediately. The rule injects a <code class="highlighter-rouge">livereload</code> script
into the browser, which causes the page to auto-refresh with the latest changes
at the completion of each build.</p>

<p><strong>Tip:</strong> You can test-drive the development server feature by running
<code class="highlighter-rouge">ibazel run src: devserver</code> on the <a href="https://github.com/alexeagle/angular-bazel-example/wiki">sample project</a>.</p>

<h3 id="testing-typescript-code-ts_web_test">Testing TypeScript code (<code class="highlighter-rouge">ts_web_test</code>)</h3>

<p>Use the <code class="highlighter-rouge">ts_web_test</code> rule to execute the Karma test runner. This rule works
best with ibazel so that both the test runner and the browser pick up your
changes at the completion of each build. For faster builds, Bazel bundles your
code and its dependencies into a single JavaScript file delivered to the browser
when the test runner executes.</p>

<p>If you need to match lots of tests with a target pattern such as bazel test //…
or using CI, run the <code class="highlighter-rouge">ts_web_test</code> rule with the regular <code class="highlighter-rouge">bazel test</code> command
instead. Bazel will then launch a headless Chrome instance and exit after a
single run.</p>

<p><strong>Tip:</strong> You can test-drive the <code class="highlighter-rouge">ts_web_test</code> rule by running <code class="highlighter-rouge">ibazel run</code> or
<code class="highlighter-rouge">bazel run</code> on the <code class="highlighter-rouge">src/hello-world:test</code> target in the <a href="https://github.com/alexeagle/angular-bazel-example/wiki">sample project</a>.</p>

<h2 id="building-angular-inputs">Building Angular inputs</h2>

<p>Bazel can build JavaScript outputs from Angular. For instructions, see <a href="https://github.com/alexeagle/angular-bazel-example/wiki/Angular-rules">Building Angular with Bazel</a>.</p>


        </div>
      </div>
    </div>

    <!-- Satisfaction Survey -->
    <script async="" defer="" src="//survey.g.doubleclick.net/async_survey?site=oohdpic4fyfp3jcnym6aqkdf3e"></script>

        <footer class="footer">
      <div class="container">
  <div class="row">
    <div class="col-sm-4 col-md-2">
      <p>About</p>
      <ul class="list-unstyled">
        <li><a href="https://github.com/bazelbuild/bazel/wiki/Bazel-Users">Who's Using Bazel?</a></li>
        <li><a href="https://www.bazel.build/roadmap.html">Roadmap</a></li>
        <li><a href="https://www.bazel.build/contributing.html">Contribute</a></li>
        <li><a href="https://www.bazel.build/governance.html">Governance Plan</a></li>
        <li><a href="https://policies.google.com/privacy">Privacy Policy</a></li>
      </ul>
    </div>
    <div class="col-sm-4 col-md-2">
      <p>Support</p>
      <ul class="list-unstyled">
        <li><a href="http://stackoverflow.com/questions/tagged/bazel">Stack Overflow</a></li>
        <li><a href="https://github.com/bazelbuild/bazel/issues">Issue Tracker</a></li>
        <li><a href="/">Documentation</a></li>
        <li><a href="https://www.bazel.build/faq.html">FAQ</a></li>
        <li><a href="https://www.bazel.build/support.html">Support Policy</a></li>
      </ul>
    </div>
    <div class="col-sm-4 col-md-2">
      <p>Stay Connected</p>
      <ul class="list-unstyled">
        <li><a href="https://twitter.com/bazelbuild">Twitter</a></li>
        <li><a href="https://blog.bazel.build">Blog</a></li>
        <li><a href="https://github.com/bazelbuild/bazel">GitHub</a></li>
        <li><a href="https://groups.google.com/forum/#!forum/bazel-discuss">Discussion group</a></li>
      </ul>
    </div>
  </div>
  <div class="row">
    <div class="col-lg-12">
      <p class="text-muted">&copy; 2018 Google</p>
    </div>
  </div>
</div>

    </footer>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="/assets/js/bootstrap.min.js"></script>

    <!-- Anchor JS -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.2.0/anchor.min.js"></script>
    <script>
      // Automatically add anchors and links to all header elements that don't already have them.
      anchors.add();
    </script>

    <script>
      var shiftWindow = function() {
        if (location.hash.length !== 0) {
          window.scrollBy(0, -50);
        }
      };
      window.addEventListener("hashchange", shiftWindow);

      var highlightCurrentSidebarNav = function() {
        var href = location.pathname;
        var item = $('#sidebar-nav [href$="' + href + '"]');
        if (item) {
          var li = item.parent();
          li.addClass("active");

          if (li.parent() && li.parent().is("ul")) {
            do {
              var ul = li.parent();
              if (ul.hasClass("collapse")) {
                ul.collapse("show");
              }
              li = ul.parent();
            } while (li && li.is("li"));
          }
        }
      };

      $(document).ready(function() {
        // Scroll to anchor of location hash, adjusted for fixed navbar.
        window.setTimeout(function() {
          shiftWindow();
        }, 1);

        // Flip the caret when submenu toggles are clicked.
        $(".sidebar-submenu").on("show.bs.collapse", function() {
          var toggle = $('[href$="#' + $(this).attr('id') + '"]');
          if (toggle) {
            toggle.addClass("dropup");
          }
        });
        $(".sidebar-submenu").on("hide.bs.collapse", function() {
          var toggle = $('[href$="#' + $(this).attr('id') + '"]');
          if (toggle) {
            toggle.removeClass("dropup");
          }
        });

        // Highlight the current page on the sidebar nav.
        highlightCurrentSidebarNav();
      });
    </script>

    <!-- Google Analytics tracking code -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-61082125-1', 'auto');
      ga('send', 'pageview');
    </script>

  </body>
</html>

