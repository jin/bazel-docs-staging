<!-- /versions/master/foo/bar -> ["master", "foo", "bar"] -->
<!-- /versions/0.12.3/baz.md -> ["0.12.3", "baz.md"] -->





<!DOCTYPE html>
<html lang="en" itemscope itemtype="https://schema.org/WebPage">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Only show Bazel version in title if it's a release -->
    <title>Configuring C++ toolchains - Bazel 2.2.0</title>

    <link rel="canonical" href="/versions/2.2.0/tutorial/cc-toolchain-config.html">

    <!-- Webfont -->
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro:400,500,700|Open+Sans:400,600,700,800" rel="stylesheet">

    <link rel="shortcut icon" type="image/png" href="/images/favicon.ico">

    <!-- Bootstrap -->
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/css/font-awesome.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Custom stylesheet -->
    <link rel="stylesheet" type="text/css" href="/css/main.css" />

    <!-- metadata -->
    <meta name="og:title" content="Configuring C++ toolchains"/>
    <meta name="og:image" content="/images/bazel-og-image.png"/>

    <!-- google search console verification -->
    <meta name="google-site-verification" content="ftWLOiP2hnDW4Cw3LUGEaXU83RVIpiyxwaXFFhoakzs" />
  </head>

  <body>
        <nav id="common-nav" class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="https://www.bazel.build/">
            <img class="navbar-logo" src="/images/bazel-navbar.svg">
          </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="https://github.com/bazelbuild/bazel">GitHub</a></li>
          </ul>
          <form class="navbar-form navbar-right" action="/search.html" id="cse-search-box">
            <div class="form-group">
              <input type="hidden" name="cx" value="009927877080525621790:2pxlpaexqpc">
              <input type="hidden" name="cof" value="FORID:10">
              <input type="hidden" name="ie" value="UTF-8">
              <input type="search" name="q" id="q" class="form-control input-sm" placeholder="Search">
            </div>
          </form>
          <ul class="nav navbar-nav navbar-right">
            <li>
              <a href="/">Documentation</a>
            </li>
            <li>
              <a href="https://www.bazel.build/contributing.html">Contribute</a>
            </li>
            <li>
              <a href="https://blog.bazel.build">Blog</a>
            </li>
            <li><a href="https://twitter.com/bazelbuild" class="nav-icon"><i class="fa fa-twitter"></i></a></li>
            <li><a href="http://stackoverflow.com/questions/tagged/bazel" class="nav-icon"><i class="fa fa-stack-overflow"></i></a></li>
          </ul>
        </div><!-- /.navbar-collapse -->
      </div><!-- /.container-fluid -->
    </nav>


    <div class="container vpad">
      <div class="row">
        <div class="col-md-2">
          <a class="btn btn-default btn-lg btn-block sidebar-toggle"
              data-toggle="collapse" href="#sidebar-nav" aria-expanded="false"
              aria-controls="sidebar-nav">
            <i class="glyphicon glyphicon-menu-hamburger"></i> Navigation
          </a>

          <nav class="sidebar collapse" id="sidebar-nav">
            <select onchange="location.href=this.value">
                <option value="" selected disabled hidden>Version: 2.2.0</option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/master/tutorial/cc-toolchain-config.html">
                    master
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/3.2.0/tutorial/cc-toolchain-config.html">
                    3.2.0
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/3.1.0/tutorial/cc-toolchain-config.html">
                    3.1.0
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/3.0.0/tutorial/cc-toolchain-config.html">
                    3.0.0
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/2.2.0/tutorial/cc-toolchain-config.html">
                    2.2.0
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/2.1.0/tutorial/cc-toolchain-config.html">
                    2.1.0
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/2.0.0/tutorial/cc-toolchain-config.html">
                    2.0.0
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/1.2.0/tutorial/cc-toolchain-config.html">
                    1.2.0
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/1.1.0/tutorial/cc-toolchain-config.html">
                    1.1.0
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/1.0.0/tutorial/cc-toolchain-config.html">
                    1.0.0
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/0.29.1/tutorial/cc-toolchain-config.html">
                    0.29.1
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/0.29.0/tutorial/cc-toolchain-config.html">
                    0.29.0
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/0.28.0/tutorial/cc-toolchain-config.html">
                    0.28.0
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/0.27.0/tutorial/cc-toolchain-config.html">
                    0.27.0
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/0.26.0/tutorial/cc-toolchain-config.html">
                    0.26.0
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/0.25.0/tutorial/cc-toolchain-config.html">
                    0.25.0
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/0.24.0/tutorial/cc-toolchain-config.html">
                    0.24.0
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/0.23.0/tutorial/cc-toolchain-config.html">
                    0.23.0
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/0.22.0/tutorial/cc-toolchain-config.html">
                    0.22.0
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/0.21.0/tutorial/cc-toolchain-config.html">
                    0.21.0
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/0.20.0/tutorial/cc-toolchain-config.html">
                    0.20.0
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/0.19.2/tutorial/cc-toolchain-config.html">
                    0.19.2
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/0.19.1/tutorial/cc-toolchain-config.html">
                    0.19.1
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/0.18.1/tutorial/cc-toolchain-config.html">
                    0.18.1
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/0.17.2/tutorial/cc-toolchain-config.html">
                    0.17.2
                </option>
                
                <!-- reconstruct absolute url for the current page for each doc version -->
                <option value="/versions/0.17.1/tutorial/cc-toolchain-config.html">
                    0.17.1
                </option>
                
            </select>

            <h3>Home</h3>
            <ul class="sidebar-nav">
              <li><a href="/versions/2.2.0/bazel-overview.html">Bazel overview</a></li>
              <li><a href="/versions/2.2.0/bazel-vision.html">Bazel vision</a></li>
              <li><a href="/versions/2.2.0/getting-started.html">Getting started</a></li>
              <li><a href="/versions/2.2.0/backward-compatibility.html">Backward compatibility</a></li>
            </ul>

            <h3>Installing Bazel</h3>
            <ul class="sidebar-nav">

              <li class="sidebar-nav">
                <a href="/versions/2.2.0/install.html">Installation overview</a>
              </li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#installing-menu" aria-expanded="false"
                    aria-controls="installing-menu">
                  Installation steps<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="installing-menu">

                   <li><a href="/versions/2.2.0/install-ubuntu.html">Ubuntu</a></li>
                   <li><a href="/versions/2.2.0/install-redhat.html">Fedora/CentOS</a></li>
                   <li><a href="/versions/2.2.0/install-os-x.html">macOS</a></li>
                   <li><a href="/versions/2.2.0/install-windows.html">Windows</a></li>
                   <li><a href="/versions/2.2.0/install-compile-source.html">Compiling from source</a></li>
                   <li><a href="/versions/2.2.0/completion.html">Command-line completion</a></li>
                   <li><a href="/versions/2.2.0/ide.html">Integrating with IDEs</a></li>
                </ul>
              </li>

              
              <li class="sidebar-nav">
                <a href="/versions/2.2.0/updating-bazel.html">Updating Bazel</a>
              </li>
              
            </ul>

            <h3>Tutorials</h3>
            <ul class="sidebar-nav">
                <li><a href="/versions/2.2.0/tutorial/cpp.html">C++</a></li>
                <li><a href="/versions/2.2.0/tutorial/java.html">Java</a></li>
                <li><a href="/versions/2.2.0/tutorial/android-app.html">Android</a></li>
                <li><a href="/versions/2.2.0/tutorial/ios-app.html">iOS</a></li>
            </ul>

            <h3>Using Bazel</h3>
            <ul class="sidebar-nav">
              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#using-menu" aria-expanded="false"
                    aria-controls="using-menu">
                  Concepts<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="using-menu">
                  <li><a href="/versions/2.2.0/build-ref.html">Core concepts</a></li>
                  <li><a href="/versions/2.2.0/external.html">External dependencies</a></li>
                  <li><a href="/versions/2.2.0/configurable-attributes.html">Configurable attributes</a></li>
                  <li><a href="/versions/master/platforms-intro.html">Platforms and toolchains</a></li>
                  <li><a href="/versions/master/visibility.html">Visibility</a></li>
                </ul>
              </li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#guides-menu" aria-expanded="false"
                    aria-controls="build-files-menu">
                  Guides<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="guides-menu">
                  <li><a href="/versions/2.2.0/guide.html">Running Bazel</a></li>
                  <li><a href="/versions/2.2.0/skylark/tutorial-creating-a-macro.html">Creating a macro</a></li>
                  <li><a href="/versions/2.2.0/memory-saving-mode.html">Optimizing memory</a></li>
                  <li><a href="/versions/2.2.0/windows.html">Building on Windows</a></li>
                </ul>
              </li>

              
                <li><a href="/versions/2.2.0/rules.html">Rules</a></li>
              

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#query-menu" aria-expanded="false"
                    aria-controls="query-menu">
                  Queries<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="query-menu">
                  <li><a href="/versions/2.2.0/query-how-to.html">The query command</a></li>
                  <li><a href="/versions/2.2.0/cquery.html">The cquery command</a></li>
                  <li><a href="/versions/2.2.0/aquery.html">The aquery command</a></li>
                  <li><a href="/versions/2.2.0/query.html">Query language</a></li>
                </ul>
              </li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#best-practices-menu" aria-expanded="false"
                    aria-controls="best-practices-menu">
                  Best practices<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="best-practices-menu">
                  <li><a href="/versions/2.2.0/best-practices.html">General best practices</a></li>
                  <li><a href="/versions/2.2.0/skylark/tutorial-sharing-variables.html">Sharing BUILD variables</a></li>
                </ul>
              </li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#remote-execution-menu" aria-expanded="false"
                    aria-controls="remote-execution-menu">
                  Remote execution<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="remote-execution-menu">
                   <li><a href="/versions/2.2.0/remote-execution.html">Overview</a></li>
                   <li><a href="/versions/2.2.0/remote-execution-rules.html">Guidelines</a></li>
                   <li>
                      <a class="sidebar-nav-heading" data-toggle="collapse"
                          href="#troubleshoot-remote-execution-menu" aria-expanded="false"
                          aria-controls="troubleshoot-remote-execution-menu">
                        Troubleshooting<span class="caret"></span>
                      </a>
                      <ul class="collapse sidebar-nav sidebar-submenu" id="troubleshoot-remote-execution-menu">
                         <li><a href="/versions/2.2.0/remote-execution-sandbox.html">Troubleshooting with Bazel sandbox</a></li>
                         <li><a href="/versions/2.2.0/workspace-log.html">Non-hermetic WORKSPACE rules</a></li>
                         <li><a href="/versions/2.2.0/remote-execution-caching-debug.html">Debugging remote cache hits</a></li>
                      </ul>
                  </li>
                   <li><a href="/versions/2.2.0/remote-execution-ci.html">Remote execution and CI</a></li>
                 </ul>
              </li>

              <li>
                  <a class="sidebar-nav-heading" data-toggle="collapse"
                      href="#remote-caching-menu" aria-expanded="false"
                      aria-controls="remote-caching-menu">
                    Remote caching<span class="caret"></span>
                  </a>
                  <ul class="collapse sidebar-nav sidebar-submenu" id="remote-caching-menu">
                     <li><a href="/versions/2.2.0/remote-caching.html">Overview</a></li>
                     <li><a href="/versions/2.2.0/remote-caching-debug.html">Debugging remote cache hits with local execution</a></li>
                  </ul>
              </li>
              
             </ul>

           

           <h3>Reference</h3>
           <ul class="sidebar-nav">
             <li><a href="/versions/2.2.0/user-manual.html">Commands and options</a></li>
             <li><a href="/versions/2.2.0/glossary.html">Glossary</a></li>
             <li><a href="/versions/2.2.0/be/overview.html">Build encyclopedia</a></li>
             <li><a href="/versions/2.2.0/test-encyclopedia.html">Test encyclopedia</a></li>
             <li><a href="/versions/2.2.0/command-line-reference.html">Command line reference</a></li>

             <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#build-files-menu" aria-expanded="false"
                    aria-controls="build-files-menu">
                  BUILD files<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="build-files-menu">
                  <li><a href="/versions/2.2.0/be/functions.html">Functions</a></li>
                  <li><a href="/versions/2.2.0/be/common-definitions.html">Common rule definitions</a></li>
                  <li><a href="/versions/2.2.0/be/make-variables.html">"Make" variables</a></li>
                  <li><a href="/versions/2.2.0/skylark/build-style.html">BUILD style guide</a></li>
                </ul>
             </li>

             <li><a href="/versions/2.2.0/build-event-protocol.html">Build Event Protocol</a></li>
             <li><a href="/versions/2.2.0/output_directories.html">Output directory layout</a></li>
             <li><a href="/versions/2.2.0/platforms.html">Platforms</a></li>
             <li><a href="/versions/2.2.0/toolchains.html">Toolchains</a></li>
           </ul>

           <h3>Extending Bazel</h3>
           <ul class="sidebar-nav">
              <li><a href="/versions/2.2.0/skylark/concepts.html">Extension overview</a></li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#starlark-concepts" aria-expanded="false"
                    aria-controls="starlark-concepts">
                  Concepts<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="starlark-concepts">
                  <li><a href="/versions/2.2.0/skylark/macros.html">Macros</a></li>
                  <li><a href="/versions/2.2.0/skylark/rules.html">Rules</a></li>
                  <li><a href="/versions/2.2.0/skylark/depsets.html">Depsets</a></li>
                  <li><a href="/versions/2.2.0/skylark/aspects.html">Aspects</a></li>
                  <li><a href="/versions/2.2.0/skylark/repository_rules.html">Repository rules</a></li>
                  <li><a href="/versions/2.2.0/skylark/config.html">Configurations</a></li>
                </ul>
              </li>

	            <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                   href="#starlark-practices" aria-expanded="false"
                   aria-controls="starlark-practices">
                  Best practices<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="starlark-practices">
                  <li><a href="/versions/2.2.0/skylark/bzl-style.html">.bzl style guide</a></li>
                  <li><a href="/versions/2.2.0/skylark/testing.html">Testing extensions</a></li>
                  <li><a href="https://github.com/bazelbuild/stardoc">Documenting rules with Stardoc</a></li>
                  <li><a href="https://github.com/bazelbuild/buildtools/tree/master/buildifier">Linting</a></li>
                  <li><a href="/versions/2.2.0/skylark/performance.html">Optimizing performance</a></li>
                  <li><a href="/versions/2.2.0/skylark/deploying.html">Deploying rules</a></li>
                  <li><a href="/versions/2.2.0/skylark/windows_tips.html">Writing rules on Windows</a></li>
                </ul>
              </li>

              <li><a href="https://github.com/bazelbuild/examples/tree/master/rules">Examples</a></li>
              <li><a href="/versions/2.2.0/skylark/lib/skylark-overview.html">Extensions API</a></li>
              <li><a href="/versions/2.2.0/skylark/faq.html">FAQ</a></li>
              <li><a href="/versions/2.2.0/skylark/language.html">Starlark language</a></li>
            </ul>
          </nav>
        </div>

        <div class="col-md-8">
          <div class="content">
            <h1 id="configuring-c-toolchains">Configuring C++ toolchains</h1>

<ul id="markdown-toc">
  <li><a href="#overview" id="markdown-toc-overview">Overview</a></li>
  <li><a href="#setting-up-the-build-environment" id="markdown-toc-setting-up-the-build-environment">Setting up the build environment</a></li>
  <li><a href="#configuring-the-c-toolchain" id="markdown-toc-configuring-the-c-toolchain">Configuring the C++ toolchain</a></li>
</ul>

<h2 id="overview">Overview</h2>

<p>This tutorial uses an example scenario to describe how to configure C++
toolchains for a project. It’s based on an
<a href="https://github.com/bazelbuild/examples/tree/master/cpp-tutorial/stage1">example C++ project</a>
that builds error-free using <code class="highlighter-rouge">gcc</code>, <code class="highlighter-rouge">clang</code>, and <code class="highlighter-rouge">msvc</code>.</p>

<p>In this tutorial, you will create a Starlark rule that provides additional
configuration for the <code class="highlighter-rouge">cc_toolchain</code> so that Bazel can build the application
with <code class="highlighter-rouge">emscripten</code>. The expected outcome is to run
<code class="highlighter-rouge">bazel build --config=asmjs //main:helloworld.js</code> on a Linux machine and build the
C++ application using <a href="https://kripken.github.io/emscripten-site/"><code class="highlighter-rouge">emscripten</code></a>
targeting <a href="http://asmjs.org/"><code class="highlighter-rouge">asm.js</code></a>.</p>

<h2 id="setting-up-the-build-environment">Setting up the build environment</h2>

<p>This tutorial assumes you are on Linux on which you have successfully built
C++ applications - in other words, we assume that appropriate tooling and
libraries have been installed.</p>

<p>Set up your build environment as follows:</p>

<ol>
  <li>
    <p>If you have not already done so,
   <a href="../install-ubuntu.html">download and install Bazel 0.23</a> or later.</p>
  </li>
  <li>
    <p>Download the
<a href="https://github.com/bazelbuild/examples/tree/master/cpp-tutorial/stage1">example C++ project</a>
from GitHub and place it in an empty directory on your local machine.</p>
  </li>
  <li>
    <p>Add the following <code class="highlighter-rouge">cc_binary</code> target to the <code class="highlighter-rouge">main/BUILD</code> file:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cc_binary(
    name = "helloworld.js",
    srcs = ["hello-world.cc"],
)
</code></pre></div>    </div>
  </li>
  <li>
    <p>Create a <code class="highlighter-rouge">.bazelrc</code> file at the root of the workspace directory with the
following contents to enable the use of the <code class="highlighter-rouge">--config</code> flag:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Use our custom-configured c++ toolchain.

build:asmjs --crosstool_top=//toolchain:emscripten

# Use --cpu as a differentiator.

build:asmjs --cpu=asmjs

# Use the default Bazel C++ toolchain to build the tools used during the
# build.

build:asmjs --host_crosstool_top=@bazel_tools//tools/cpp:toolchain
</code></pre></div>    </div>
  </li>
</ol>

<p>In this example, we are using the <code class="highlighter-rouge">--cpu</code> flag as a differentiator, since
<code class="highlighter-rouge">emscripten</code> can target both <code class="highlighter-rouge">asmjs</code> and Web assembly. We are not configuring a
Web assembly toolchain, however. Since Bazel uses many internal tools written in
C++, such as process-wrapper, we are specifying a “sane” C++ toolchain for the
host platform.</p>

<h2 id="configuring-the-c-toolchain">Configuring the C++ toolchain</h2>

<p>To configure the C++ toolchain, repeatedly build the application and eliminate
each error one by one as described below.</p>

<p><strong>Note:</strong> This tutorial assumes you’re using Bazel 0.23 or later. If you’re
using an older release of Bazel, look for the “Configuring CROSSTOOL” tutorial.</p>

<ol>
  <li>
    <p>Run the build with the following command:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bazel build --config=asmjs //main:helloworld.js
</code></pre></div>    </div>

    <p>Because you specified <code class="highlighter-rouge">--crosstool_top=//toolchain:emscripten</code> in the
<code class="highlighter-rouge">.bazelrc</code> file, Bazel throws the following error:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>No such package `toolchain`: BUILD file not found on package path.
</code></pre></div>    </div>

    <p>In the workspace directory, create the <code class="highlighter-rouge">toolchain</code> directory for the package
and an empty <code class="highlighter-rouge">BUILD</code> file inside the <code class="highlighter-rouge">toolchain</code> directory.</p>
  </li>
  <li>
    <p>Run the build again. Because the <code class="highlighter-rouge">toolchain</code> package does not yet define the
<code class="highlighter-rouge">emscripten</code> target, Bazel throws the following error:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">No</span> <span class="n">such</span> <span class="n">target</span> <span class="s1">'//toolchain:emscripten'</span><span class="p">:</span> <span class="n">target</span> <span class="s1">'emscripten'</span> <span class="k">not</span> <span class="n">declared</span> <span class="k">in</span>
<span class="k">package</span> <span class="s1">'toolchain'</span> <span class="n">defined</span> <span class="n">by</span> <span class="p">.../</span><span class="n">toolchain</span><span class="p">/</span><span class="n">BUILD</span>
</code></pre></div>    </div>

    <p>In the <code class="highlighter-rouge">toolchain/BUILD</code> file, define an empty filegroup as follows:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>package(default_visibility = ['//visibility:public'])
filegroup(name = "emscripten")
</code></pre></div>    </div>
  </li>
  <li>
    <p>Run the build again. Bazel throws the following error:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'//toolchain:emscripten' does not have mandatory providers: 'ToolchainInfo'
</code></pre></div>    </div>

    <p>Bazel discovered that the <code class="highlighter-rouge">--crosstool_top</code> flag points to a rule that
doesn’t provide the necessary <code class="highlighter-rouge">ToolchainInfo</code> provider. So we need to point
<code class="highlighter-rouge">--crosstool_top</code> to a rule that does provide <code class="highlighter-rouge">ToolchainInfo</code> - that is the
<code class="highlighter-rouge">cc_toolchain_suite</code> rule. In the <code class="highlighter-rouge">toolchain/BUILD</code> file, replace the empty
filegroup with the following:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cc_toolchain_suite(
    name = "emscripten",
    toolchains = {
        "asmjs": ":asmjs_toolchain",
    },
)
</code></pre></div>    </div>

    <p>The <code class="highlighter-rouge">toolchains</code> attribute automatically maps the <code class="highlighter-rouge">--cpu</code> (and also
<code class="highlighter-rouge">--compiler</code> when specified) values to  <code class="highlighter-rouge">cc_toolchain</code>. You have not yet
defined any <code class="highlighter-rouge">cc_toolchain</code> targets and Bazel will complain about that
shortly.</p>
  </li>
  <li>
    <p>Run the build again. Bazel throws the following error:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Rule '//toolchain:asmjs_toolchain' does not exist
</code></pre></div>    </div>

    <p>Now you need to define <code class="highlighter-rouge">cc_toolchain</code> targets for every value in the
<code class="highlighter-rouge">cc_toolchain_suite.toolchains</code> attribute. This is where you specify the
files that comprise the toolchain so that Bazel can set up sandboxing. Add
the following to the <code class="highlighter-rouge">toolchain/BUILD</code> file:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>filegroup(name = "empty")

cc_toolchain(
    name = "asmjs_toolchain",
    toolchain_identifier = "asmjs-toolchain",
    toolchain_config = ":asmjs_toolchain_config",
    all_files = ":empty",
    compiler_files = ":empty",
    dwp_files = ":empty",
    linker_files = ":empty",
    objcopy_files = ":empty",
    strip_files = ":empty",
    supports_param_files = 0,
)
</code></pre></div>    </div>
  </li>
  <li>
    <p>Run the build again. Bazel throws the following error:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Rule '//toolchain:asmjs-toolchain' does not exist
</code></pre></div>    </div>

    <p>Let’s add a “:asmjs-toolchain-config” target to the <code class="highlighter-rouge">toolchain/BUILD</code> file:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>filegroup(name = "asmjs_toolchain_config")
</code></pre></div>    </div>
  </li>
  <li>
    <p>Run the build again. Bazel throws the following error:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'//toolchain:asmjs_toolchain_config' does not have mandatory providers:
'CcToolchainConfigInfo'
</code></pre></div>    </div>

    <p><code class="highlighter-rouge">CcToolchainConfigInfo</code> is a provider that we use to configure our C++
toolchains. We are going to create a Starlark rule that will provide
<code class="highlighter-rouge">CcToolchainConfigInfo</code>. Create a <code class="highlighter-rouge">toolchain/cc_toolchain_config.bzl</code>
file with the following content:</p>
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def _impl(ctx):
    return cc_common.create_cc_toolchain_config_info(
        ctx = ctx,
        toolchain_identifier = "asmjs-toolchain",
        host_system_name = "i686-unknown-linux-gnu",
        target_system_name = "asmjs-unknown-emscripten",
        target_cpu = "asmjs",
        target_libc = "unknown",
        compiler = "emscripten",
        abi_version = "unknown",
        abi_libc_version = "unknown",
    )

cc_toolchain_config = rule(
    implementation = _impl,
    attrs = {},
    provides = [CcToolchainConfigInfo],
)
</code></pre></div>    </div>

    <p><code class="highlighter-rouge">cc_common.create_cc_toolchain_config_info()</code> creates the needed provider
<code class="highlighter-rouge">CcToolchainConfigInfo</code>. Now let’s declare a rule that will make use of
the newly implemented <code class="highlighter-rouge">cc_toolchain_config</code> rule. Add a load statement to
<code class="highlighter-rouge">toolchains/BUILD</code>:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>load(":cc_toolchain_config.bzl", "cc_toolchain_config")
</code></pre></div>    </div>

    <p>And replace the “asmjs_toolchain_config” filegroup with a declaration of a
<code class="highlighter-rouge">cc_toolchain_config</code> rule:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cc_toolchain_config(name = "asmjs_toolchain_config")
</code></pre></div>    </div>
  </li>
  <li>
    <p>Run the build again. Bazel throws the following error:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>.../BUILD:1:1: C++ compilation of rule '//:helloworld.js' failed (Exit 1)
src/main/tools/linux-sandbox-pid1.cc:421:
"execvp(toolchain/DUMMY_GCC_TOOL, 0x11f20e0)": No such file or directory
Target //:helloworld.js failed to build`
</code></pre></div>    </div>

    <p>At this point, Bazel has enough information to attempt building the code but
it still does not know what tools to use to complete the required build
actions. We will modify our Starlark rule implementation to tell Bazel what
tools to use. For that, we’ll need the tool_path() constructor from
<a href="https://source.bazel.build/bazel/+/4eea5c62a566d21832c93e4c18ec559e75d5c1ce:tools/cpp/cc_toolchain_config_lib.bzl;l=400"><code class="highlighter-rouge">@bazel_tools//tools/cpp:cc_toolchain_config_lib.bzl</code></a>:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># toolchain/cc_toolchain_config.bzl:
load("@bazel_tools//tools/cpp:cc_toolchain_config_lib.bzl", "tool_path")

def _impl(ctx):
    tool_paths = [
        tool_path(
            name = "gcc",
            path = "emcc.sh",
        ),
        tool_path(
            name = "ld",
            path = "emcc.sh",
        ),
        tool_path(
            name = "ar",
            path = "/bin/false",
        ),
        tool_path(
            name = "cpp",
            path = "/bin/false",
        ),
        tool_path(
            name = "gcov",
            path = "/bin/false",
        ),
        tool_path(
            name = "nm",
            path = "/bin/false",
        ),
        tool_path(
            name = "objdump",
            path = "/bin/false",
        ),
        tool_path(
            name = "strip",
            path = "/bin/false",
        ),
    ]
    return cc_common.create_cc_toolchain_config_info(
        ctx = ctx,
        toolchain_identifier = "asmjs-toolchain",
        host_system_name = "i686-unknown-linux-gnu",
        target_system_name = "asmjs-unknown-emscripten",
        target_cpu = "asmjs",
        target_libc = "unknown",
        compiler = "emscripten",
        abi_version = "unknown",
        abi_libc_version = "unknown",
        tool_paths = tool_paths,
    )
</code></pre></div>    </div>

    <p>You may notice the <code class="highlighter-rouge">emcc.sh</code> wrapper script, which delegates to the external
<code class="highlighter-rouge">emcc.py</code> file. Create the script in the <code class="highlighter-rouge">toolchain</code> package directory with
the following contents and set its executable bit:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>
<span class="nb">set</span> <span class="nt">-euo</span> pipefail
python external/emscripten_toolchain/emcc.py <span class="s2">"</span><span class="nv">$@</span><span class="s2">"</span>
</code></pre></div>    </div>

    <p>Paths specified in the <code class="highlighter-rouge">tool_paths</code> list are relative to the package where
the <code class="highlighter-rouge">cc_toolchain_config</code> target is specified.</p>

    <p>The <code class="highlighter-rouge">emcc.py</code> file does not yet exist in the workspace directory. To obtain
it, you can either check the <code class="highlighter-rouge">emscripten</code> toolchain in with your project or
pull it from its GitHub repository. This tutorial uses the latter approach.
To pull the toolchain from the GitHub repository, add the following
<code class="highlighter-rouge">http_archive</code> repository definitions to your <code class="highlighter-rouge">WORKSPACE</code> file:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>load("@bazel_tools//tools/build_defs/repo:http.bzl", "http_archive")

http_archive(
  name = 'emscripten_toolchain',
  url = 'https://github.com/kripken/emscripten/archive/1.37.22.tar.gz',
  build_file = '//:emscripten-toolchain.BUILD',
  strip_prefix = "emscripten-1.37.22",
)

http_archive(
  name = 'emscripten_clang',
  url = 'https://s3.amazonaws.com/mozilla-games/emscripten/packages/llvm/tag/linux_64bit/emscripten-llvm-e1.37.22.tar.gz',
  build_file = '//:emscripten-clang.BUILD',
  strip_prefix = "emscripten-llvm-e1.37.22",
)
</code></pre></div>    </div>

    <p>In the workspace directory root, create the <code class="highlighter-rouge">emscripten-toolchain.BUILD</code> and
<code class="highlighter-rouge">emscripten-clang.BUILD</code> files that expose these repositories as filegroups
and establish their visibility across the build.</p>

    <p>In the workspace directory root, make sure that a <code class="highlighter-rouge">BUILD</code> file is present.
If not, create an empty one.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>touch BUILD
</code></pre></div>    </div>

    <p>First create the <code class="highlighter-rouge">emscripten-toolchain.BUILD</code> file with the following
contents:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>package(default_visibility = ['//visibility:public'])

filegroup(
  name = "all",
  srcs = glob(["**/*"]),
)
</code></pre></div>    </div>

    <p>Next, create the <code class="highlighter-rouge">emscripten-clang.BUILD</code> file with the following contents:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>package(default_visibility = ['//visibility:public'])`

filegroup(
  name = "all",
  srcs = glob(["**/*"]),
)
</code></pre></div>    </div>

    <p>You may notice that the targets simply parse all of the files contained in
the archives pulled by the <code class="highlighter-rouge">http_archive</code> repository rules. In a real
world scenario, you would likely want to be more selective and granular by
only parsing the files needed by the build and splitting them by action,
such as compilation, linking, and so on. For the sake of simplicity, this
tutorial omits this step.</p>
  </li>
  <li>
    <p>Run the build again. Bazel throws the following error:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"execvp(toolchain/emcc.sh, 0x12bd0e0)": No such file or directory
</code></pre></div>    </div>

    <p>You now need to make Bazel aware of the artifacts you added in the previous
step. In particular, the <code class="highlighter-rouge">emcc.sh</code> script must also be explicitly listed as
a dependency of the corresponding <code class="highlighter-rouge">cc_toolchain</code> rule. Modify the
<code class="highlighter-rouge">toolchain/BUILD</code> file to look as follows:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>package(default_visibility = ["//visibility:public"])

load(":cc_toolchain_config.bzl", "cc_toolchain_config")

cc_toolchain_config(name = "asmjs_toolchain_config")

cc_toolchain_suite(
    name = "emscripten",
    toolchains = {
        "asmjs": ":asmjs_toolchain",
    },
)

filegroup(
    name = "all",
    srcs = [
        "emcc.sh",
        "@emscripten_clang//:all",
        "@emscripten_toolchain//:all",
    ],
)

cc_toolchain(
   name = "asmjs_toolchain",
   toolchain_identifier = "asmjs-toolchain",
   toolchain_config = ":asmjs_toolchain_config",
   all_files = ":all",
   compiler_files = ":all",
   dwp_files = ":empty",
   linker_files = ":all",
   objcopy_files = ":empty",
   strip_files = ":empty",
   supports_param_files = 0,
)
</code></pre></div>    </div>

    <p>Congratulations! You are now using the <code class="highlighter-rouge">emscripten</code> toolchain to build your
C++ sample code.  The next steps are optional but are included for
completeness.</p>
  </li>
  <li>
    <p>(Optional) Run the build again. Bazel throws the following error:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ERROR: .../BUILD:1:1: C++ compilation of rule '//:helloworld.js' failed (Exit 1)
</code></pre></div>    </div>

    <p>The next step is to make the toolchain deterministic and hermetic - that
 is, limit it to only touch files it’s supposed to touch and ensure it
 doesn’t write temporary data outside the sandbox.</p>

    <p>You also need to ensure the toolchain does not assume the existence of your
 home directory with its configuration files and that it does not depend on
 unspecified environment variables.</p>

    <p>For our example project, make the following modifications to the
 <code class="highlighter-rouge">toolchain/BUILD</code> file:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> filegroup(
   name = "all",
   srcs = [
     "emcc.sh",
     "@emscripten_toolchain//:all",
     "@emscripten_clang//:all",
     ":emscripten_cache_content"
     ],
  )

 filegroup(
   name = "emscripten_cache_content",
   srcs = glob(["emscripten_cache/**/*"]),
 )
</code></pre></div>    </div>

    <p>Since <code class="highlighter-rouge">emscripten</code> caches standard library files, you can save time by not
 compiling <code class="highlighter-rouge">stdlib</code> for every action and also prevent it from storing
 temporary data in random place, check in the precompiled bitcode files into
 the <code class="highlighter-rouge">toolchain/emscript_cache directory</code>. You can create them by calling
 the following from the <code class="highlighter-rouge">emscripten_clang</code> repository (or let <code class="highlighter-rouge">emscripten</code>
 create them in <code class="highlighter-rouge">~/.emscripten_cache</code>):</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> python embuilder.py build dlmalloc libcxx libc gl libcxxabi libcxx_noexcept wasm-libc
</code></pre></div>    </div>

    <p>Copy those files to <code class="highlighter-rouge">toolchain/emscripten_cache</code>.
 Also update the <code class="highlighter-rouge">emcc.sh</code> script to look as follows:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="c">#!/bin/bash</span>

 <span class="nb">set</span> <span class="nt">-euo</span> pipefail

 <span class="nb">export </span><span class="nv">LLVM_ROOT</span><span class="o">=</span><span class="s1">'external/emscripten_clang'</span>
 <span class="nb">export </span><span class="nv">EMSCRIPTEN_NATIVE_OPTIMIZER</span><span class="o">=</span><span class="s1">'external/emscripten_clang/optimizer'</span>
 <span class="nb">export </span><span class="nv">BINARYEN_ROOT</span><span class="o">=</span><span class="s1">'external/emscripten_clang/'</span>
 <span class="nb">export </span><span class="nv">NODE_JS</span><span class="o">=</span><span class="s1">''</span>
 <span class="nb">export </span><span class="nv">EMSCRIPTEN_ROOT</span><span class="o">=</span><span class="s1">'external/emscripten_toolchain'</span>
 <span class="nb">export </span><span class="nv">SPIDERMONKEY_ENGINE</span><span class="o">=</span><span class="s1">''</span>
 <span class="nb">export </span><span class="nv">EM_EXCLUSIVE_CACHE_ACCESS</span><span class="o">=</span>1
 <span class="nb">export </span><span class="nv">EMCC_SKIP_SANITY_CHECK</span><span class="o">=</span>1
 <span class="nb">export </span><span class="nv">EMCC_WASM_BACKEND</span><span class="o">=</span>0

 <span class="nb">mkdir</span> <span class="nt">-p</span> <span class="s2">"tmp/emscripten_cache"</span>

 <span class="nb">export </span><span class="nv">EM_CACHE</span><span class="o">=</span><span class="s2">"tmp/emscripten_cache"</span>
 <span class="nb">export </span><span class="nv">TEMP_DIR</span><span class="o">=</span><span class="s2">"tmp"</span>

 <span class="c"># Prepare the cache content so emscripten doesn't keep rebuilding it</span>
 <span class="nb">cp</span> <span class="nt">-r</span> toolchain/emscripten_cache/<span class="k">*</span> tmp/emscripten_cache

 <span class="c"># Run emscripten to compile and link</span>
 python external/emscripten_toolchain/emcc.py <span class="s2">"</span><span class="nv">$@</span><span class="s2">"</span>

 <span class="c"># Remove the first line of .d file</span>
 find <span class="nb">.</span> <span class="nt">-name</span> <span class="s2">"*.d"</span> <span class="nt">-exec</span> <span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'2d'</span> <span class="o">{}</span> <span class="se">\;</span>
</code></pre></div>    </div>

    <p>Bazel can now properly compile the sample C++ code in <code class="highlighter-rouge">hello-world.cc</code>.</p>
  </li>
  <li>
    <p>(Optional) Run the build again. Bazel throws the following error:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>..../BUILD:1:1: undeclared inclusion(s) in rule '//:helloworld.js':
this rule is missing dependency declarations for the following files included by 'helloworld.cc':
'.../external/emscripten_toolchain/system/include/libcxx/stdio.h'
'.../external/emscripten_toolchain/system/include/libcxx/__config'
'.../external/emscripten_toolchain/system/include/libc/stdio.h'
'.../external/emscripten_toolchain/system/include/libc/features.h'
'.../external/emscripten_toolchain/system/include/libc/bits/alltypes.h'
</code></pre></div>    </div>

    <p>At this point you have successfully compiled the example C++ code. The
error above occurs because Bazel uses a <code class="highlighter-rouge">.d</code> file produced by the compiler
to verify that all includes have been declared and to prune action inputs.</p>

    <p>In the <code class="highlighter-rouge">.d</code> file, Bazel discovered that our source code references system
headers that have not been explicitly declared in the <code class="highlighter-rouge">BUILD</code> file. This in
and of itself is not a problem and you can easily fix this by adding the
target folders as <code class="highlighter-rouge">-isystem</code> directories. For this, you’ll need to add
a <a href="https://source.bazel.build/bazel/+/4eea5c62a566d21832c93e4c18ec559e75d5c1ce:tools/cpp/cc_toolchain_config_lib.bzl;l=336"><code class="highlighter-rouge">feature</code></a> to the <code class="highlighter-rouge">CcToolchainConfigInfo</code>.
Modify <code class="highlighter-rouge">toolchain/cc_toolchain_config.bzl</code> to look like this:</p>
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>load("@bazel_tools//tools/cpp:cc_toolchain_config_lib.bzl",
     "feature",
     "flag_group",
     "flag_set",
     "tool_path")
load("@bazel_tools//tools/build_defs/cc:action_names.bzl", "ACTION_NAMES")

def _impl(ctx):
    tool_paths = [
        tool_path(
            name = "gcc",
            path = "emcc.sh",
        ),
        tool_path(
            name = "ld",
            path = "emcc.sh",
        ),
        tool_path(
            name = "ar",
            path = "/bin/false",
        ),
        tool_path(
            name = "cpp",
            path = "/bin/false",
        ),
        tool_path(
            name = "gcov",
            path = "/bin/false",
        ),
        tool_path(
            name = "nm",
            path = "/bin/false",
        ),
        tool_path(
            name = "objdump",
            path = "/bin/false",
        ),
        tool_path(
            name = "strip",
            path = "/bin/false",
        ),
    ]
    toolchain_include_directories_feature = feature(
        name = "toolchain_include_directories",
        enabled = True,
        flag_sets = [
            flag_set(
                actions = [
                    ACTION_NAMES.assemble,
                    ACTION_NAMES.preprocess_assemble,
                    ACTION_NAMES.linkstamp_compile,
                    ACTION_NAMES.c_compile,
                    ACTION_NAMES.cpp_compile,
                    ACTION_NAMES.cpp_header_parsing,
                    ACTION_NAMES.cpp_module_compile,
                    ACTION_NAMES.cpp_module_codegen,
                    ACTION_NAMES.lto_backend,
                    ACTION_NAMES.clif_match,
                ],
                flag_groups = [
                    flag_group(
                        flags = [
                            "-isystem",
                            "external/emscripten_toolchain/system/include/libcxx",
                            "-isystem",
                            "external/emscripten_toolchain/system/include/libc",
                        ],
                    ),
                ],
            ),
        ],
    )

    return cc_common.create_cc_toolchain_config_info(
        ctx = ctx,
        toolchain_identifier = "asmjs-toolchain",
        host_system_name = "i686-unknown-linux-gnu",
        target_system_name = "asmjs-unknown-emscripten",
        target_cpu = "asmjs",
        target_libc = "unknown",
        compiler = "emscripten",
        abi_version = "unknown",
        abi_libc_version = "unknown",
        tool_paths = tool_paths,
        features = [toolchain_include_directories_feature],
    )

cc_toolchain_config = rule(
    implementation = _impl,
    attrs = {},
    provides = [CcToolchainConfigInfo],
)
</code></pre></div>    </div>
  </li>
  <li>
    <p>(Optional) Run the build again. With this final change, the build now
completes error-free.</p>
  </li>
</ol>

          </div>
        </div>

        <div class="col-md-2 sticky-sidebar">
            <div class="right-sidebar">
                <ul class="gh-links">
                    <li><a href="https://github.com/bazelbuild/bazel/issues/new?title=Documentation issue: Configuring C++ toolchains&body=Documentation URL: https://docs.bazel.build/versions/2.2.0/tutorial/cc-toolchain-config.html&labels=type: documentation"><i class="fa fa-github"></i> Create issue</a></li>
                    <li id="gh-edit-list-item" class="default-hidden" aria-hidden="true"><a id="gh-edit" class="gh-edit default-hidden"><i class="fa fa-pencil" aria-hidden="true"></i> Edit this page</a></li>
                </ul>
                <script>
                 var versionDocsURLRegex = /\/versions\/[\w\.]+\/(.*)/;
                 var ghDocsBazeURL = 'https://github.com/bazelbuild/bazel/tree/master/site/docs/';
                 var editButton = document.getElementById('gh-edit');
                 var editButtonListItem = document.getElementById('gh-edit-list-item');
                 // if there is an edit button and we are not in the Build Encyclopedia
                 // or other generated files.
                 if (editButton
                     && window.location.pathname.match(versionDocsURLRegex)
                     && window.location.pathname.lastIndexOf('/be/') == -1
                     && window.location.pathname.lastIndexOf('/repo/') == -1
                     && window.location.pathname.lastIndexOf('/skylark/lib/') == -1
                     && window.location.pathname.lastIndexOf('/command-line-reference.html') == -1) {
                     var docFile = window.location.pathname.match(versionDocsURLRegex)[1];
                     // some pages are not using markdown :(
                     if (docFile !== 'user-manual.html'
                         && docFile !== 'build-ref.html'
                         && docFile !== 'query.html'
                         && docFile !== 'test-encyclopedia.html') {
                         docFile = docFile.replace('html', 'md');
                     }
                     editButton.href = ghDocsBazeURL + docFile;
                     editButton.style.visibility = 'visible';
                     editButtonListItem.style.visibility = 'visible';
                 }
                </script>

                <ul class="page-toc">
<li class="toc-entry toc-h2"><a href="#overview">Overview</a></li>
<li class="toc-entry toc-h2"><a href="#setting-up-the-build-environment">Setting up the build environment</a></li>
<li class="toc-entry toc-h2"><a href="#configuring-the-c-toolchain">Configuring the C++ toolchain</a></li>
</ul>
            </div>
        </div>
      </div>
    </div>

    <!-- Satisfaction Survey -->
    <script async="" defer="" src="//www.google.com/insights/consumersurveys/async_survey?site=hihwpyy5e5kllsq62elzjrcgn4"></script>

        <footer class="footer">
      <div class="container">
  <div class="row">
    <div class="col-sm-4 col-md-2">
      <p>About</p>
      <ul class="list-unstyled">
        <li><a href="https://github.com/bazelbuild/bazel/wiki/Bazel-Users">Who's Using Bazel?</a></li>
        <li><a href="https://www.bazel.build/roadmap.html">Roadmap</a></li>
        <li><a href="https://www.bazel.build/contributing.html">Contribute</a></li>
        <li><a href="https://www.bazel.build/governance.html">Governance Plan</a></li>
        <li><a href="https://policies.google.com/privacy">Privacy Policy</a></li>
        <li><a href="//sitemap.xml">Sitemap</a></li>
      </ul>
    </div>
    <div class="col-sm-4 col-md-2">
      <p>Support</p>
      <ul class="list-unstyled">
        <li><a href="http://stackoverflow.com/questions/tagged/bazel">Stack Overflow</a></li>
        <li><a href="https://github.com/bazelbuild/bazel/issues">Issue Tracker</a></li>
        <li><a href="/">Documentation</a></li>
        <li><a href="https://www.bazel.build/faq.html">FAQ</a></li>
        <li><a href="https://www.bazel.build/support.html">Support Policy</a></li>
      </ul>
    </div>
    <div class="col-sm-4 col-md-2">
      <p>Stay Connected</p>
      <ul class="list-unstyled">
        <li><a href="https://twitter.com/bazelbuild">Twitter</a></li>
        <li><a href="https://blog.bazel.build">Blog</a></li>
        <li><a href="https://github.com/bazelbuild/bazel">GitHub</a></li>
        <li><a href="https://groups.google.com/forum/#!forum/bazel-discuss">Discussion group</a></li>
        <li><a href="https://slack.bazel.build">Slack</a></li>
      </ul>
    </div>
  </div>
  <div class="row">
    <div class="col-lg-12">
      <p class="text-muted">&copy; 2020 Google</p>
    </div>
  </div>
</div>

    </footer>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="/assets/js/bootstrap.min.js"></script>

    <!-- Anchor JS -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.2.0/anchor.min.js"></script>
    <script>
      // Automatically add anchors and links to all header elements that don't already have them.
      anchors.add();
    </script>

    <script>
      var shiftWindow = function() {
        if (location.hash.length !== 0) {
          window.scrollBy(0, -50);
        }
      };
      window.addEventListener("hashchange", shiftWindow);

      var highlightCurrentSidebarNav = function() {
        var href = location.pathname;
        var item = $('#sidebar-nav [href$="' + href + '"]');
        if (item) {
          var li = item.parent();
          li.addClass("active");

          if (li.parent() && li.parent().is("ul")) {
            do {
              var ul = li.parent();
              if (ul.hasClass("collapse")) {
                ul.collapse("show");
              }
              li = ul.parent();
            } while (li && li.is("li"));
          }
        }
      };

      $(document).ready(function() {
        // Scroll to anchor of location hash, adjusted for fixed navbar.
        window.setTimeout(function() {
          shiftWindow();
        }, 1);

        // Flip the caret when submenu toggles are clicked.
        $(".sidebar-submenu").on("show.bs.collapse", function() {
          var toggle = $('[href$="#' + $(this).attr('id') + '"]');
          if (toggle) {
            toggle.addClass("dropup");
          }
        });
        $(".sidebar-submenu").on("hide.bs.collapse", function() {
          var toggle = $('[href$="#' + $(this).attr('id') + '"]');
          if (toggle) {
            toggle.removeClass("dropup");
          }
        });

        // Highlight the current page on the sidebar nav.
        highlightCurrentSidebarNav();
      });
    </script>

    <!-- Google Analytics tracking code -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-61082125-1', 'auto');
      ga('send', 'pageview');
    </script>

  </body>
</html>

