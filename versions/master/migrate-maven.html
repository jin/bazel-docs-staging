<!DOCTYPE html>
<html lang="en" itemscope itemtype="https://schema.org/WebPage">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Migrating from Maven to Bazel - Bazel</title>

    <link rel="canonical" href="/versions/master/migrate-maven.html">

    <!-- Webfont -->
    <link href="//fonts.googleapis.com/css?family=RobotoDraft:300,400,500,700|Source+Code+Pro:400,500,700" rel="stylesheet">

    <link rel="shortcut icon" type="image/png" href="/images/favicon.ico">

    <!-- Bootstrap -->
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/css/font-awesome.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Custom stylesheet -->
    <link rel="stylesheet" type="text/css" href="/css/main.css" />

    <!-- metadata -->
    <meta name="og:title" content="Migrating from Maven to Bazel"/>
    <meta name="og:image" content="/images/bazel-og-image.png"/>

    <!-- google search console verification -->
    <meta name="google-site-verification" content="ftWLOiP2hnDW4Cw3LUGEaXU83RVIpiyxwaXFFhoakzs" />
  </head>

  <body>
        <nav id="common-nav" class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="https://www.bazel.build/">
            <img class="navbar-logo" src="/images/bazel-navbar.svg">
          </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="https://github.com/bazelbuild/bazel">GitHub</a></li>
          </ul>
          <form class="navbar-form navbar-right" action="/search.html" id="cse-search-box">
            <div class="form-group">
              <input type="hidden" name="cx" value="012346921571893344015:xv_nfgpzbu4">
              <input type="hidden" name="cof" value="FORID:10">
              <input type="hidden" name="ie" value="UTF-8">
              <input type="search" name="q" class="form-control input-sm" placeholder="Search">
            </div>
          </form>
          <ul class="nav navbar-nav navbar-right">
            <li>
              <a href="/">Documentation</a>
            </li>
            <li>
              <a href="https://www.bazel.build/contributing.html">Contribute</a>
            </li>
            <li>
              <a href="https://blog.bazel.build">Blog</a>
            </li>
            <li><a href="https://twitter.com/bazelbuild" class="nav-icon"><i class="fa fa-twitter"></i></a></li>
            <li><a href="http://stackoverflow.com/questions/tagged/bazel" class="nav-icon"><i class="fa fa-stack-overflow"></i></a></li>
          </ul>
        </div><!-- /.navbar-collapse -->
      </div><!-- /.container-fluid -->
    </nav>


    <div class="page-title-bar">
      <div class="container">
        <h1>Documentation</h1>
      </div>
    </div>

    <div class="container vpad">
      <div class="row">
        <div class="col-md-3">
          <a class="btn btn-default btn-lg btn-block sidebar-toggle"
              data-toggle="collapse" href="#sidebar-nav" aria-expanded="false"
              aria-controls="sidebar-nav">
            <i class="glyphicon glyphicon-menu-hamburger"></i> Navigation
          </a>
          <nav class="sidebar collapse" id="sidebar-nav">
           <h3>Home</h3>
            <ul class="sidebar-nav">
              <li><a href="/versions/master/bazel-overview.html">Bazel Overview</a></li>
              <li><a href="/versions/master/bazel-vision.html">Bazel Vision</a></li>
              <li><a href="/versions/master/getting-started.html">Getting Started</a></li>
              <li><a href="/versions/master/skylark/backward-compatibility.html">Backward Compatibility</a></li>
            </ul>

           <h3>Using Bazel</h3>
            <ul class="sidebar-nav">

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#installing-menu" aria-expanded="false"
                    aria-controls="installing-menu">
                  Installing Bazel<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="installing-menu">
                   <li><a href="/versions/master/install.html">Installation Overview</a></li>
                   <li><a href="/versions/master/install-ubuntu.html">Installing on Ubuntu</a></li>
                   <li><a href="/versions/master/install-redhat.html">Installing on Fedora/CentOS</a></li>
                   <li><a href="/versions/master/install-os-x.html">Installing on macOS</a></li>
                   <li><a href="/versions/master/install-windows.html">Installing on Windows</a></li>
                   <li><a href="/versions/master/install-compile-source.html">Compiling from Source</a></li>
                   <li><a href="/versions/master/completion.html">Command-Line Completion</a></li>
                   <li><a href="/versions/master/ide.html">Integrating with IDEs</a></li>
                 </ul>
                </li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#tutorials-menu" aria-expanded="false"
                    aria-controls="tutorials-menu">
                  Tutorials<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="tutorials-menu">
                   <li><a href="/versions/master/tutorial/java.html">Building a Java Project</a></li>
                   <li><a href="/versions/master/tutorial/cpp.html">Building a C++ Project</a></li>
                   <li><a href="/versions/master/tutorial/android-app.html">Building an Android App</a></li>
                   <li><a href="/versions/master/tutorial/ios-app.html">Building an iOS App</a></li>
                   <li><a href="/versions/master/skylark/tutorial-sharing-variables.html">Sharing Variables</a></li>
                   <li><a href="/versions/master/skylark/tutorial-creating-a-macro.html">Creating a Macro</a></li>
                 </ul>
              </li>

              <li><a href="/versions/master/build-ref.html">Bazel Concepts</a></li>
              <li><a href="/versions/master/guide.html">User's Guide</a></li>
              <li><a href="/versions/master/external.html">External Dependencies</a></li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#query-menu" aria-expanded="false"
                    aria-controls="query-menu">
                  Queries<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="query-menu">
                  <li><a href="/versions/master/query-how-to.html">Bazel query</a></li>
                  <li><a href="/versions/master/cquery.html">Bazel cquery</a></li>
                  <li><a href="/versions/master/user-manual.html#aquery">Bazel aquery</a></li>
                  <li><a href="/versions/master/query.html">Query Language</a></li>
                </ul>
              </li>

              <li><a href="/versions/master/configurable-attributes.html">Configurable Attributes</a></li>
              <li><a href="/versions/master/best-practices.html">Best Practices</a></li>
              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#remote-execution-menu" aria-expanded="false"
                    aria-controls="remote-execution-menu">
                  Remote Execution<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="remote-execution-menu">
                   <li><a href="/versions/master/remote-execution.html">Remote Execution Overview</a></li>
                   <li><a href="/versions/master/remote-execution-rules.html">Guidelines for Remote Execution</a></li>
                   <li>
                      <a class="sidebar-nav-heading" data-toggle="collapse"
                          href="#troubleshoot-remote-execution-menu" aria-expanded="false"
                          aria-controls="troubleshoot-remote-execution-menu">
                        Troubleshooting Remote Execution<span class="caret"></span>
                      </a>
                      <ul class="collapse sidebar-nav sidebar-submenu" id="troubleshoot-remote-execution-menu">
                         <li><a href="/versions/master/remote-execution-sandbox.html">Troubleshooting Remote Execution with Bazel Sandbox</a></li>
                         <li><a href="/versions/master/workspace-log.html">Finding non-hermetic behavior in WORKSPACE rules</a></li>
                      </ul>
                  </li>
                   <li><a href="/versions/master/remote-execution-ci.html">Configuring Bazel CI for Remote Execution Rule Testing</a></li>
                 </ul>
              </li>

              <li><a href="/versions/master/remote-caching.html">Remote Caching</a></li>
             </ul>

           <h3>Rules</h3>
           <ul class="sidebar-nav">
             <li><a href="/versions/master/be/overview.html">Build Encyclopedia</a></li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#android-menu" aria-expanded="false"
                    aria-controls="android-menu">
                  Android<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="android-menu">
                  <li><a href="/versions/master/bazel-and-android.html">Android Resources</a></li>
                  <li><a href="/versions/master/mobile-install.html">Using mobile-install</a></li>
                  <li><a href="/versions/master/android-instrumentation-test.html">Android Instrumentation Tests</a></li>
                  <li><a href="/versions/master/android-ndk.html">Android NDK</a></li>
                  <li><a href="https://plugins.jetbrains.com/plugin/9185-bazel">Android Studio Plugin</a></li>
                </ul>
              </li>

               <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#apple-menu" aria-expanded="false"
                    aria-controls="apple-menu">
                  Apple<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="apple-menu">
                  <li><a href="/versions/master/bazel-and-apple.html">Apple Resources</a></li>
                  <li><a href="/versions/master/migrate-xcode.html">Migrating from Xcode</a></li>
                  <li><a href="/versions/master/migrate-cocoapods.html">Converting CocoaPods</a></li>
                </ul>
              </li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#cpp-menu" aria-expanded="false"
                    aria-controls="cpp-menu">
                  C++<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="cpp-menu">
                  <li><a href="/versions/master/bazel-and-cpp.html">C++ Resources</a></li>
                  <li><a href="/versions/master/cpp-use-cases.html">C++ Use Cases</a></li>
                  <li><a href="/versions/master/crosstool-reference.html">Understanding CROSSTOOL</a></li>
                  <li><a href="/versions/master/tutorial/crosstool.html">Tutorial: CROSSTOOL</a></li>
                </ul>
              </li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#java-menu" aria-expanded="false"
                    aria-controls="java-menu">
                  Java<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="java-menu">
                  <li><a href="/versions/master/bazel-and-java.html">Java Resources</a></li>
                  <li><a href="/versions/master/migrate-maven.html">Migrating from Maven</a></li>
                  <li><a href="/versions/master/generate-workspace.html">Converting Maven Dependencies</a></li>
                </ul>
              </li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#javascript-menu" aria-expanded="false"
                    aria-controls="javascript-menu">
                  JavaScript<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="javascript-menu">
                  <li><a href="/versions/master/bazel-and-javascript.html">JavaScript Resources</a></li>
                  <li><a href="/versions/master/build-javascript.html">Building JavaScript</a></li>
                </ul>
              </li>

           </ul>

           <h3>Reference</h3>
           <ul class="sidebar-nav">
             <li><a href="/versions/master/user-manual.html">Commands and Options</a></li>
             <li><a href="/versions/master/skylark/build-style.html">BUILD Style Guide</a></li>
             <li><a href="/versions/master/command-line-reference.html">Command Line Reference</a></li>
             <li><a href="/versions/master/test-encyclopedia.html">Writing Tests</a></li>
             <li><a href="/versions/master/build-event-protocol.html">Build Event Protocol</a></li>
             <li><a href="/versions/master/output_directories.html">Output Directory Layout</a></li>
             <li><a href="/versions/master/platforms.html">Platforms</a></li>
             <li><a href="/versions/master/toolchains.html">Toolchains</a></li>
           </ul>

            <h3>Extending Bazel</h3>
           <ul class="sidebar-nav">
              <li><a href="/versions/master/skylark/concepts.html">Extension Overview</a></li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#starlark-concepts" aria-expanded="false"
                    aria-controls="starlark-concepts">
                  Concepts<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="starlark-concepts">
                  <li><a href="/versions/master/skylark/macros.html">Macros</a></li>
                  <li><a href="/versions/master/skylark/rules.html">Rules</a></li>
                  <li><a href="/versions/master/skylark/depsets.html">Depsets</a></li>
                  <li><a href="/versions/master/skylark/aspects.html">Aspects</a></li>
                  <li><a href="/versions/master/skylark/repository_rules.html">Repository Rules</a></li>
                  <li><a href="/versions/master/skylark/faq.html">FAQ</a></li>
                </ul>
              </li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#starlark-practices" aria-expanded="false"
                    aria-controls="starlark-practices">
                  Best Practices<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="starlark-practices">
                  <li><a href="/versions/master/skylark/bzl-style.html">.bzl Style Guide</a></li>
                  <li><a href="/versions/master/skylark/testing.html">Testing</a></li>
                  <li><a href="https://skydoc.bazel.build" target="_blank">Documenting Rules</a></li>
                  <li><a href="/versions/master/skylark/skylint.html">Linter</a></li>
                  <li><a href="/versions/master/skylark/performance.html">Optimizing Performance</a></li>
                  <li><a href="/versions/master/skylark/deploying.html">Deploying Rules</a></li>
                </ul>
              </li>

              <li><a href="https://github.com/bazelbuild/examples/tree/master/rules">Examples</a></li>
              <li><a href="/versions/master/skylark/lib/skylark-overview.html">API Reference</a></li>
              <li><a href="/versions/master/skylark/language.html">Starlark Language</a></li>
            </ul>
          </nav>
        </div>

        <div class="col-md-9">
          <a id="gh-edit" class="gh-edit default-hidden"><i class="fa fa-pencil" aria-hidden="true"></i> Edit</a>
          <script>
            var versionDocsURLRegex = /\/versions\/[\w\.]+\/(.*)/;
            var ghDocsBazeURL = 'https://github.com/bazelbuild/bazel/tree/master/site/docs/';
            var editButton = document.getElementById('gh-edit');
            // if there is an edit button and we are not in the Build Encyclopedia
            if (editButton
                && window.location.pathname.match(versionDocsURLRegex)
                && window.location.pathname.lastIndexOf('/be/') == -1
                && window.location.pathname.lastIndexOf('/skylark/lib/') == -1) {
              var docFile = window.location.pathname.match(versionDocsURLRegex)[1];
              // some pages are not using markdown :(
              if (docFile !== 'user-manual.html'
                  && docFile !== 'build-ref.html'
                  && docFile !== 'query.html'
                  && docFile !== 'test-encyclopedia.html') {
                docFile = docFile.replace('html', 'md');
              }
              editButton.href = ghDocsBazeURL + docFile;
              editButton.style.visibility = 'visible';
            }
          </script>

          <!-- /versions/master/foo/bar -> ["master", "foo", "bar"] -->
          <!-- /versions/0.12.3/baz.md -> ["0.12.3", "baz.md"] -->
          

          <p>Documentation for Bazel master</p>
          <select id="touchsplashmenu" onchange="location.href=this.value">
              <option value="">Choose a Bazel version</option>
              
              <option value="/versions/master/migrate-maven.html">master</option>
              
              <option value="/versions/0.19.2/migrate-maven.html">0.19.2</option>
              
              <option value="/versions/0.19.1/migrate-maven.html">0.19.1</option>
              
              <option value="/versions/0.18.1/migrate-maven.html">0.18.1</option>
              
              <option value="/versions/0.17.2/migrate-maven.html">0.17.2</option>
              
              <option value="/versions/0.17.1/migrate-maven.html">0.17.1</option>
              
          </select>

          <h1 id="migrating-from-maven-to-bazel">Migrating from Maven to Bazel</h1>

<p>When migrating from any build tool to Bazel, it’s best to have both build
tools running in parallel until you have fully migrated your development team,
CI system, and any other relevant systems. You can run Maven and Bazel in the
same repository.</p>

<h2 id="table-of-contents">Table of contents</h2>

<ul>
  <li><a href="#before-you-begin">Before you begin</a></li>
  <li><a href="#differences-between-maven-and-bazel">Differences between Maven and Bazel</a></li>
  <li><a href="#migrate-from-maven-to-bazel">Migrate from Maven to Bazel:</a>
    <ul>
      <li><a href="#1-workspace">1. Create the WORKSPACE file</a>
        <ul>
          <li><a href="#guava-1">Guava project example</a></li>
        </ul>
      </li>
      <li><a href="#2-build">2. Create one BUILD file</a>
        <ul>
          <li><a href="#guava-2">Guava project example</a></li>
        </ul>
      </li>
      <li><a href="#3-build">3. Create more BUILD files  (Optional)</a></li>
      <li><a href="#4-build">4. Build using Bazel</a></li>
    </ul>
  </li>
</ul>

<h2 id="before-you-begin">Before you begin</h2>

<ul>
  <li><a href="install.html">Install Bazel</a> if it’s not yet installed.</li>
  <li>If you’re new to Bazel, go through the tutorial
<a href="tutorial/java.html">Introduction to Bazel: Build Java</a> before you start
migrating. The tutorial explains Bazel’s concepts, structure, and label
syntax.</li>
</ul>

<h2 id="differences-between-maven-and-bazel">Differences between Maven and Bazel</h2>

<ul>
  <li>Maven uses top-level <code class="highlighter-rouge">pom.xml</code> file(s). Bazel supports multiple build
files and multiple targets per BUILD file, allowing for builds that
are more incremental than Maven’s.</li>
  <li>Maven takes charge of steps for the deployment process. Bazel does
not automate deployment.</li>
  <li>Bazel enables you to express dependencies between languages.</li>
  <li>As you add new sections to the project, with Bazel you may need to add new
BUILD files. Best practice is to add a BUILD file to each new Java package.</li>
</ul>

<h2 id="migrate-from-maven-to-bazel">Migrate from Maven to Bazel</h2>

<p>The steps below describe how to migrate your project to Bazel:</p>

<ol>
  <li><a href="#1-workspace">Create the WORKSPACE file</a></li>
  <li><a href="#2-build">Create one BUILD file</a></li>
  <li><a href="#3-build">Create more BUILD files</a></li>
  <li><a href="#4-build">Build using Bazel</a></li>
</ol>

<p>Examples below come from a migration of the
<a href="https://github.com/google/guava">Guava project</a> from Maven to Bazel. The Guava
project used is release 22.0. The examples using Guava do not walk through
each step in the migration, but they do show the files and contents that are
generated or added manually for the migration.</p>

<h3 id="1-create-the-workspace-file"><a name="1-workspace"></a>1. Create the WORKSPACE file</h3>

<p>Create a file named <code class="highlighter-rouge">WORKSPACE</code> at the root of your project. If your project
has no external dependencies, the workspace file can be empty.</p>

<p>If your project depends on files or packages that are not in one of the
project’s directories, specify these external dependencies in the workspace
file. To automate the listing of external dependencies for the workspace file,
use the tool <code class="highlighter-rouge">generate_workspace</code>. For instructions about using this tool, see
<a href="generate-workspace.html">Generate a WORKSPACE file for a Java project</a>.</p>

<h4 id="guava-project-example-external-dependencies"><a name="guava-1"></a>Guava project example: external dependencies</h4>

<p>Below are the results of using the tool <code class="highlighter-rouge">generate_workspace</code> to list the
<a href="https://github.com/google/guava">Guava project’s</a> external dependencies.</p>

<ol>
  <li>
    <p>The new <code class="highlighter-rouge">WORKSPACE</code> file contains:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>load<span class="o">(</span><span class="s2">"//:generate_workspace.bzl"</span>, <span class="s2">"generated_maven_jars"</span><span class="o">)</span>
generated_maven_jars<span class="o">()</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>The new <code class="highlighter-rouge">BUILD</code> file in the directory <code class="highlighter-rouge">third_party</code> enables access
to external libraries. This BUILD file contains:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>load<span class="o">(</span><span class="s2">"//:generate_workspace.bzl"</span>, <span class="s2">"generated_java_libraries"</span><span class="o">)</span>
generated_java_libraries<span class="o">()</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>The generated <code class="highlighter-rouge">generate_workspace.bzl</code> file contains:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># The following dependencies were calculated from:</span>
<span class="c">#</span>
<span class="c"># generate_workspace --maven_project=/usr/local/.../guava</span>


def generated_maven_jars<span class="o">()</span>:
  <span class="c"># pom.xml got requested version</span>
  <span class="c"># com.google.guava:guava-parent:pom:23.0-SNAPSHOT</span>
  native.maven_jar<span class="o">(</span>
      name <span class="o">=</span> <span class="s2">"com_google_code_findbugs_jsr305"</span>,
      artifact <span class="o">=</span> <span class="s2">"com.google.code.findbugs:jsr305:1.3.9"</span>,
      sha1 <span class="o">=</span> <span class="s2">"40719ea6961c0cb6afaeb6a921eaa1f6afd4cfdf"</span>,
  <span class="o">)</span>


  <span class="c"># pom.xml got requested version</span>
  <span class="c"># com.google.guava:guava-parent:pom:23.0-SNAPSHOT</span>
  native.maven_jar<span class="o">(</span>
      name <span class="o">=</span> <span class="s2">"com_google_errorprone_error_prone_annotations"</span>,
      artifact <span class="o">=</span> <span class="s2">"com.google.errorprone:error_prone_annotations:2.0.18"</span>,
      sha1 <span class="o">=</span> <span class="s2">"5f65affce1684999e2f4024983835efc3504012e"</span>,
  <span class="o">)</span>


  <span class="c"># pom.xml got requested version</span>
  <span class="c"># com.google.guava:guava-parent:pom:23.0-SNAPSHOT</span>
  native.maven_jar<span class="o">(</span>
      name <span class="o">=</span> <span class="s2">"com_google_j2objc_j2objc_annotations"</span>,
      artifact <span class="o">=</span> <span class="s2">"com.google.j2objc:j2objc-annotations:1.1"</span>,
      sha1 <span class="o">=</span> <span class="s2">"ed28ded51a8b1c6b112568def5f4b455e6809019"</span>,
  <span class="o">)</span>




def generated_java_libraries<span class="o">()</span>:
  native.java_library<span class="o">(</span>
      name <span class="o">=</span> <span class="s2">"com_google_code_findbugs_jsr305"</span>,
      visibility <span class="o">=</span> <span class="o">[</span><span class="s2">"//visibility:public"</span><span class="o">]</span>,
      exports <span class="o">=</span> <span class="o">[</span><span class="s2">"@com_google_code_findbugs_jsr305//jar"</span><span class="o">]</span>,
  <span class="o">)</span>


  native.java_library<span class="o">(</span>
      name <span class="o">=</span> <span class="s2">"com_google_errorprone_error_prone_annotations"</span>,
      visibility <span class="o">=</span> <span class="o">[</span><span class="s2">"//visibility:public"</span><span class="o">]</span>,
      exports <span class="o">=</span> <span class="o">[</span><span class="s2">"@com_google_errorprone_error_prone_annotations//jar"</span><span class="o">]</span>,
  <span class="o">)</span>


  native.java_library<span class="o">(</span>
      name <span class="o">=</span> <span class="s2">"com_google_j2objc_j2objc_annotations"</span>,
      visibility <span class="o">=</span> <span class="o">[</span><span class="s2">"//visibility:public"</span><span class="o">]</span>,
      exports <span class="o">=</span> <span class="o">[</span><span class="s2">"@com_google_j2objc_j2objc_annotations//jar"</span><span class="o">]</span>,
  <span class="o">)</span>
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="2-create-one-build-file"><a name="2-build"></a>2. Create one BUILD file</h3>

<p>Now that you have your workspace defined and external dependencies (if
applicable) listed, you need to create BUILD files to describe how your project
should be built. Unlike Maven with its one <code class="highlighter-rouge">pom.xml</code> file, Bazel can use many
BUILD files to build a project. These files specify multiple build targets,
which allow Bazel to produce incremental builds.</p>

<p>Add BUILD files in stages. Start with adding one BUILD file
at the root of your project and using it to do an initial build using Bazel.
Then, you refine your build by adding more BUILD files with more granular
targets.</p>

<ol>
  <li>
    <p>In the same directory as your <code class="highlighter-rouge">WORKSPACE</code> file, create a text file and
name it <code class="highlighter-rouge">BUILD</code>.</p>
  </li>
  <li>In this BUILD file, use the appropriate rule to create one target to
build your project. Here are some tips:
    <ul>
      <li>Use the appropriate rule:
        <ul>
          <li>
            <p>To build projects with a single Maven module, use the
<code class="highlighter-rouge">java_library</code> rule as follows:</p>

            <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java_library<span class="o">(</span>
    name <span class="o">=</span> <span class="s2">"everything"</span>,
    srcs <span class="o">=</span> glob<span class="o">([</span><span class="s2">"src/main/java/**/*.java"</span><span class="o">])</span>,
    resources <span class="o">=</span> glob<span class="o">([</span><span class="s2">"src/main/resources/**"</span><span class="o">])</span>,
    deps <span class="o">=</span> <span class="o">[</span><span class="s2">"//:all-external-targets"</span><span class="o">]</span>,
<span class="o">)</span>
</code></pre></div>            </div>
          </li>
          <li>
            <p>To build projects with multiple Maven modules, use the
<code class="highlighter-rouge">java_library</code> rule as follows:</p>

            <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java_library<span class="o">(</span>
    name <span class="o">=</span> <span class="s2">"everything"</span>,
    srcs <span class="o">=</span> glob<span class="o">([</span>
        <span class="s2">"Module1/src/main/java/**/*.java"</span>,
        <span class="s2">"Module2/src/main/java/**/*.java"</span>,
        ...
    <span class="o">])</span>,
    resources <span class="o">=</span> glob<span class="o">([</span>
        <span class="s2">"Module1/src/main/resources/**"</span>,
        <span class="s2">"Module2/src/main/resources/**"</span>,
        ...
    <span class="o">])</span>,
    deps <span class="o">=</span> <span class="o">[</span><span class="s2">"//:all-external-targets"</span><span class="o">]</span>,
<span class="o">)</span>
</code></pre></div>            </div>
          </li>
          <li>
            <p>To build binaries, use the <code class="highlighter-rouge">java_binary</code> rule:</p>

            <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java_binary<span class="o">(</span>
    name <span class="o">=</span> <span class="s2">"everything"</span>,
    srcs <span class="o">=</span> glob<span class="o">([</span><span class="s2">"src/main/java/**/*.java"</span><span class="o">])</span>,
    resources <span class="o">=</span> glob<span class="o">([</span><span class="s2">"src/main/resources/**"</span><span class="o">])</span>,
    deps <span class="o">=</span> <span class="o">[</span><span class="s2">"//:all-external-targets"</span><span class="o">]</span>,
    main_class <span class="o">=</span> <span class="s2">"com.example.Main"</span>
<span class="o">)</span>
</code></pre></div>            </div>
          </li>
        </ul>
      </li>
      <li>Specify the attributes:
        <ul>
          <li><code class="highlighter-rouge">name</code>: Give the target a meaningful name. In the examples above
we call the target “everything.”</li>
          <li><code class="highlighter-rouge">srcs</code>: Use globbing to list all .java files in your project.</li>
          <li><code class="highlighter-rouge">resources</code>: Use globbing to list all resources in your project.</li>
          <li><code class="highlighter-rouge">deps</code>: You need to determine which external dependencies your
project needs. For example, if you generated a list of external
dependencies using the tool <code class="highlighter-rouge">generate_workspace</code>, the dependencies
for <code class="highlighter-rouge">java_library</code> are the libraries listed in the
<code class="highlighter-rouge">generated_java_libraries</code> macro.</li>
        </ul>
      </li>
      <li>Take a look at the
<a href="#guava-example-2">example below of this top-level BUILD file</a> from
the migration of the Guava project.</li>
    </ul>
  </li>
  <li>
    <p>Now that you have a BUILD file at the root of your project, build
your project to ensure that it works. On the command line, from your
workspace directory, use <code class="highlighter-rouge">bazel build //:everything</code> to build your
project with Bazel.</p>

    <p>The project has now been successfully built with Bazel. You will need
to add more BUILD files to allow incremental builds of the project.</p>
  </li>
</ol>

<h4 id="guava-project-example-start-with-one-build-file"><a name="guava-2"></a>Guava project example: start with one BUILD file</h4>

<p>When migrating the Guava project to Bazel, initially one BUILD file is used
to build the entire project. Here are the contents of this initial <code class="highlighter-rouge">BUILD</code>
file in the workspace directory:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java_library<span class="o">(</span>
    name <span class="o">=</span> <span class="s2">"everything"</span>,
    srcs <span class="o">=</span> glob<span class="o">([</span><span class="s2">"guava/src/**/*.java"</span><span class="o">])</span>,
    deps <span class="o">=</span> <span class="o">[</span>
      <span class="s2">"//third_party:com_google_code_findbugs_jsr305"</span>,
      <span class="s2">"//third_party:com_google_errorprone_error_prone_annotations"</span>,
      <span class="s2">"//third_party:com_google_j2objc_j2objc_annotations"</span>
    <span class="o">]</span>,
<span class="o">)</span>
</code></pre></div></div>

<h3 id="3-create-more-build-files-optional"><a name="3-build"></a>3. Create more BUILD files (Optional)</h3>

<p>Bazel does work with just one BUILD file, as you saw after completing your first
build. You should still consider breaking the build into smaller chunks by
adding more BUILD files with granular targets.</p>

<p>Multiple BUILD files with multiple targets will give the build increased
granularity, allowing:</p>

<ul>
  <li>increased incremental builds of the project,</li>
  <li>increased parallel execution of the build,</li>
  <li>better maintainability of the build for future users, and</li>
  <li>control over visibility of targets between packages, which can prevent
issues such as libraries containing implementation details leaking into
public APIs.</li>
</ul>

<p>Tips for adding more BUILD files:</p>

<ul>
  <li>You can start by adding a BUILD file to each Java package. Start with
Java packages that have the fewest dependencies and work you way up
to packages with the most dependencies.</li>
  <li>As you add BUILD files and specify targets, add these new targets to the
<code class="highlighter-rouge">deps</code> sections of targets that depend on them. Note that the <code class="highlighter-rouge">glob()</code>
function does not cross package boundaries, so as the number
of packages grows the files matched by <code class="highlighter-rouge">glob()</code> will shrink.</li>
  <li>Any time you add a BUILD file to a <code class="highlighter-rouge">main</code> directory, ensure that you add
a BUILD file to the corresponding <code class="highlighter-rouge">test</code> directory.</li>
  <li>Take care to limit visibility properly between packages.</li>
  <li>To simplify troubleshooting errors in your setup of BUILD files, ensure
that the project continues to build with Bazel as you add each build
file. Run <code class="highlighter-rouge">bazel build //...</code> to ensure all of your targets still build.</li>
</ul>

<h3 id="4-build-using-bazel"><a name="4-build"></a>4. Build using Bazel</h3>

<p>You’ve been building using Bazel as you add BUILD files to validate the setup
of the build.</p>

<p>When you have BUILD files at the desired granularity, you can use Bazel
to produce all of your builds.</p>

        </div>
      </div>
    </div>

    <!-- Satisfaction Survey -->
    <script async="" defer="" src="//survey.g.doubleclick.net/async_survey?site=oohdpic4fyfp3jcnym6aqkdf3e"></script>

        <footer class="footer">
      <div class="container">
  <div class="row">
    <div class="col-sm-4 col-md-2">
      <p>About</p>
      <ul class="list-unstyled">
        <li><a href="https://github.com/bazelbuild/bazel/wiki/Bazel-Users">Who's Using Bazel?</a></li>
        <li><a href="https://www.bazel.build/roadmap.html">Roadmap</a></li>
        <li><a href="https://www.bazel.build/contributing.html">Contribute</a></li>
        <li><a href="https://www.bazel.build/governance.html">Governance Plan</a></li>
        <li><a href="https://policies.google.com/privacy">Privacy Policy</a></li>
      </ul>
    </div>
    <div class="col-sm-4 col-md-2">
      <p>Support</p>
      <ul class="list-unstyled">
        <li><a href="http://stackoverflow.com/questions/tagged/bazel">Stack Overflow</a></li>
        <li><a href="https://github.com/bazelbuild/bazel/issues">Issue Tracker</a></li>
        <li><a href="/">Documentation</a></li>
        <li><a href="https://www.bazel.build/faq.html">FAQ</a></li>
        <li><a href="https://www.bazel.build/support.html">Support Policy</a></li>
      </ul>
    </div>
    <div class="col-sm-4 col-md-2">
      <p>Stay Connected</p>
      <ul class="list-unstyled">
        <li><a href="https://twitter.com/bazelbuild">Twitter</a></li>
        <li><a href="https://blog.bazel.build">Blog</a></li>
        <li><a href="https://github.com/bazelbuild/bazel">GitHub</a></li>
        <li><a href="https://groups.google.com/forum/#!forum/bazel-discuss">Discussion group</a></li>
      </ul>
    </div>
  </div>
  <div class="row">
    <div class="col-lg-12">
      <p class="text-muted">&copy; 2018 Google</p>
    </div>
  </div>
</div>

    </footer>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="/assets/js/bootstrap.min.js"></script>

    <!-- Anchor JS -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.2.0/anchor.min.js"></script>
    <script>
      // Automatically add anchors and links to all header elements that don't already have them.
      anchors.add();
    </script>

    <script>
      var shiftWindow = function() {
        if (location.hash.length !== 0) {
          window.scrollBy(0, -50);
        }
      };
      window.addEventListener("hashchange", shiftWindow);

      var highlightCurrentSidebarNav = function() {
        var href = location.pathname;
        var item = $('#sidebar-nav [href$="' + href + '"]');
        if (item) {
          var li = item.parent();
          li.addClass("active");

          if (li.parent() && li.parent().is("ul")) {
            do {
              var ul = li.parent();
              if (ul.hasClass("collapse")) {
                ul.collapse("show");
              }
              li = ul.parent();
            } while (li && li.is("li"));
          }
        }
      };

      $(document).ready(function() {
        // Scroll to anchor of location hash, adjusted for fixed navbar.
        window.setTimeout(function() {
          shiftWindow();
        }, 1);

        // Flip the caret when submenu toggles are clicked.
        $(".sidebar-submenu").on("show.bs.collapse", function() {
          var toggle = $('[href$="#' + $(this).attr('id') + '"]');
          if (toggle) {
            toggle.addClass("dropup");
          }
        });
        $(".sidebar-submenu").on("hide.bs.collapse", function() {
          var toggle = $('[href$="#' + $(this).attr('id') + '"]');
          if (toggle) {
            toggle.removeClass("dropup");
          }
        });

        // Highlight the current page on the sidebar nav.
        highlightCurrentSidebarNav();
      });
    </script>

    <!-- Google Analytics tracking code -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-61082125-1', 'auto');
      ga('send', 'pageview');
    </script>

  </body>
</html>

