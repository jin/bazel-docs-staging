<!DOCTYPE html>
<html lang="en" itemscope itemtype="https://schema.org/WebPage">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Build Tutorial - Android - Bazel</title>

    <link rel="canonical" href="/versions/master/tutorial/android-app.html">

    <!-- Webfont -->
    <link href="//fonts.googleapis.com/css?family=RobotoDraft:300,400,500,700|Source+Code+Pro:400,500,700" rel="stylesheet">

    <link rel="shortcut icon" type="image/png" href="/images/favicon.ico">

    <!-- Bootstrap -->
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/css/font-awesome.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Custom stylesheet -->
    <link rel="stylesheet" type="text/css" href="/css/main.css" />

    <!-- metadata -->
    <meta name="og:title" content="Build Tutorial - Android"/>
    <meta name="og:image" content="/images/bazel-og-image.png"/>

    <!-- google search console verification -->
    <meta name="google-site-verification" content="ftWLOiP2hnDW4Cw3LUGEaXU83RVIpiyxwaXFFhoakzs" />
  </head>

  <body>
        <nav id="common-nav" class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="https://www.bazel.build/">
            <img class="navbar-logo" src="/images/bazel-navbar.svg">
          </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="https://github.com/bazelbuild/bazel">GitHub</a></li>
          </ul>
          <form class="navbar-form navbar-right" action="/search.html" id="cse-search-box">
            <div class="form-group">
              <input type="hidden" name="cx" value="012346921571893344015:xv_nfgpzbu4">
              <input type="hidden" name="cof" value="FORID:10">
              <input type="hidden" name="ie" value="UTF-8">
              <input type="search" name="q" class="form-control input-sm" placeholder="Search">
            </div>
          </form>
          <ul class="nav navbar-nav navbar-right">
            <li>
              <a href="/">Documentation</a>
            </li>
            <li>
              <a href="https://www.bazel.build/contributing.html">Contribute</a>
            </li>
            <li>
              <a href="https://blog.bazel.build">Blog</a>
            </li>
            <li><a href="https://twitter.com/bazelbuild" class="nav-icon"><i class="fa fa-twitter"></i></a></li>
            <li><a href="http://stackoverflow.com/questions/tagged/bazel" class="nav-icon"><i class="fa fa-stack-overflow"></i></a></li>
          </ul>
        </div><!-- /.navbar-collapse -->
      </div><!-- /.container-fluid -->
    </nav>


    <div class="page-title-bar">
      <div class="container">
        <h1>Documentation</h1>
      </div>
    </div>

    <div class="container vpad">
      <div class="row">
        <div class="col-md-3">
          <a class="btn btn-default btn-lg btn-block sidebar-toggle"
              data-toggle="collapse" href="#sidebar-nav" aria-expanded="false"
              aria-controls="sidebar-nav">
            <i class="glyphicon glyphicon-menu-hamburger"></i> Navigation
          </a>
          <nav class="sidebar collapse" id="sidebar-nav">
           <h3>Home</h3>
            <ul class="sidebar-nav">
              <li><a href="/versions/master/bazel-overview.html">Bazel Overview</a></li>
              <li><a href="/versions/master/bazel-vision.html">Bazel Vision</a></li>
              <li><a href="/versions/master/getting-started.html">Getting Started</a></li>
              <li><a href="/versions/master/skylark/backward-compatibility.html">Backward Compatibility</a></li>
            </ul>

           <h3>Using Bazel</h3>
            <ul class="sidebar-nav">

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#installing-menu" aria-expanded="false"
                    aria-controls="installing-menu">
                  Installing Bazel<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="installing-menu">
                   <li><a href="/versions/master/install.html">Installation Overview</a></li>
                   <li><a href="/versions/master/install-ubuntu.html">Installing on Ubuntu</a></li>
                   <li><a href="/versions/master/install-redhat.html">Installing on Fedora/CentOS</a></li>
                   <li><a href="/versions/master/install-os-x.html">Installing on macOS</a></li>
                   <li><a href="/versions/master/install-windows.html">Installing on Windows</a></li>
                   <li><a href="/versions/master/install-compile-source.html">Compiling from Source</a></li>
                   <li><a href="/versions/master/completion.html">Command-Line Completion</a></li>
                   <li><a href="/versions/master/ide.html">Integrating with IDEs</a></li>
                 </ul>
                </li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#tutorials-menu" aria-expanded="false"
                    aria-controls="tutorials-menu">
                  Tutorials<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="tutorials-menu">
                   <li><a href="/versions/master/tutorial/java.html">Building a Java Project</a></li>
                   <li><a href="/versions/master/tutorial/cpp.html">Building a C++ Project</a></li>
                   <li><a href="/versions/master/tutorial/android-app.html">Building an Android App</a></li>
                   <li><a href="/versions/master/tutorial/ios-app.html">Building an iOS App</a></li>
                   <li><a href="/versions/master/skylark/tutorial-sharing-variables.html">Sharing Variables</a></li>
                   <li><a href="/versions/master/skylark/tutorial-creating-a-macro.html">Creating a Macro</a></li>
                 </ul>
              </li>

              <li><a href="/versions/master/build-ref.html">Bazel Concepts</a></li>
              <li><a href="/versions/master/guide.html">User's Guide</a></li>
              <li><a href="/versions/master/external.html">External Dependencies</a></li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#query-menu" aria-expanded="false"
                    aria-controls="query-menu">
                  Queries<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="query-menu">
                  <li><a href="/versions/master/query-how-to.html">Bazel query</a></li>
                  <li><a href="/versions/master/cquery.html">Bazel cquery</a></li>
                  <li><a href="/versions/master/user-manual.html#aquery">Bazel aquery</a></li>
                  <li><a href="/versions/master/query.html">Query Language</a></li>
                </ul>
              </li>

              <li><a href="/versions/master/configurable-attributes.html">Configurable Attributes</a></li>
              <li><a href="/versions/master/best-practices.html">Best Practices</a></li>
              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#remote-execution-menu" aria-expanded="false"
                    aria-controls="remote-execution-menu">
                  Remote Execution<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="remote-execution-menu">
                   <li><a href="/versions/master/remote-execution.html">Remote Execution Overview</a></li>
                   <li><a href="/versions/master/remote-execution-rules.html">Guidelines for Remote Execution</a></li>
                   <li>
                      <a class="sidebar-nav-heading" data-toggle="collapse"
                          href="#troubleshoot-remote-execution-menu" aria-expanded="false"
                          aria-controls="troubleshoot-remote-execution-menu">
                        Troubleshooting Remote Execution<span class="caret"></span>
                      </a>
                      <ul class="collapse sidebar-nav sidebar-submenu" id="troubleshoot-remote-execution-menu">
                         <li><a href="/versions/master/remote-execution-sandbox.html">Troubleshooting Remote Execution with Bazel Sandbox</a></li>
                         <li><a href="/versions/master/workspace-log.html">Finding non-hermetic behavior in WORKSPACE rules</a></li>
                      </ul>
                  </li>
                   <li><a href="/versions/master/remote-execution-ci.html">Configuring Bazel CI for Remote Execution Rule Testing</a></li>
                 </ul>
              </li>

              <li><a href="/versions/master/remote-caching.html">Remote Caching</a></li>
             </ul>

           <h3>Rules</h3>
           <ul class="sidebar-nav">
             <li><a href="/versions/master/be/overview.html">Build Encyclopedia</a></li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#android-menu" aria-expanded="false"
                    aria-controls="android-menu">
                  Android<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="android-menu">
                  <li><a href="/versions/master/bazel-and-android.html">Android Resources</a></li>
                  <li><a href="/versions/master/mobile-install.html">Using mobile-install</a></li>
                  <li><a href="/versions/master/android-instrumentation-test.html">Android Instrumentation Tests</a></li>
                  <li><a href="/versions/master/android-ndk.html">Android NDK</a></li>
                  <li><a href="https://plugins.jetbrains.com/plugin/9185-bazel">Android Studio Plugin</a></li>
                </ul>
              </li>

               <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#apple-menu" aria-expanded="false"
                    aria-controls="apple-menu">
                  Apple<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="apple-menu">
                  <li><a href="/versions/master/bazel-and-apple.html">Apple Resources</a></li>
                  <li><a href="/versions/master/migrate-xcode.html">Migrating from Xcode</a></li>
                  <li><a href="/versions/master/migrate-cocoapods.html">Converting CocoaPods</a></li>
                </ul>
              </li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#cpp-menu" aria-expanded="false"
                    aria-controls="cpp-menu">
                  C++<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="cpp-menu">
                  <li><a href="/versions/master/bazel-and-cpp.html">C++ Resources</a></li>
                  <li><a href="/versions/master/cpp-use-cases.html">C++ Use Cases</a></li>
                  <li><a href="/versions/master/crosstool-reference.html">Understanding CROSSTOOL</a></li>
                  <li><a href="/versions/master/tutorial/crosstool.html">Tutorial: CROSSTOOL</a></li>
                </ul>
              </li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#java-menu" aria-expanded="false"
                    aria-controls="java-menu">
                  Java<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="java-menu">
                  <li><a href="/versions/master/bazel-and-java.html">Java Resources</a></li>
                  <li><a href="/versions/master/migrate-maven.html">Migrating from Maven</a></li>
                  <li><a href="/versions/master/generate-workspace.html">Converting Maven Dependencies</a></li>
                </ul>
              </li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#javascript-menu" aria-expanded="false"
                    aria-controls="javascript-menu">
                  JavaScript<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="javascript-menu">
                  <li><a href="/versions/master/bazel-and-javascript.html">JavaScript Resources</a></li>
                  <li><a href="/versions/master/build-javascript.html">Building JavaScript</a></li>
                </ul>
              </li>

           </ul>

           <h3>Reference</h3>
           <ul class="sidebar-nav">
             <li><a href="/versions/master/user-manual.html">Commands and Options</a></li>
             <li><a href="/versions/master/skylark/build-style.html">BUILD Style Guide</a></li>
             <li><a href="/versions/master/command-line-reference.html">Command Line Reference</a></li>
             <li><a href="/versions/master/test-encyclopedia.html">Writing Tests</a></li>
             <li><a href="/versions/master/build-event-protocol.html">Build Event Protocol</a></li>
             <li><a href="/versions/master/output_directories.html">Output Directory Layout</a></li>
             <li><a href="/versions/master/platforms.html">Platforms</a></li>
             <li><a href="/versions/master/toolchains.html">Toolchains</a></li>
           </ul>

            <h3>Extending Bazel</h3>
           <ul class="sidebar-nav">
              <li><a href="/versions/master/skylark/concepts.html">Extension Overview</a></li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#starlark-concepts" aria-expanded="false"
                    aria-controls="starlark-concepts">
                  Concepts<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="starlark-concepts">
                  <li><a href="/versions/master/skylark/macros.html">Macros</a></li>
                  <li><a href="/versions/master/skylark/rules.html">Rules</a></li>
                  <li><a href="/versions/master/skylark/depsets.html">Depsets</a></li>
                  <li><a href="/versions/master/skylark/aspects.html">Aspects</a></li>
                  <li><a href="/versions/master/skylark/repository_rules.html">Repository Rules</a></li>
                  <li><a href="/versions/master/skylark/faq.html">FAQ</a></li>
                </ul>
              </li>

              <li>
                <a class="sidebar-nav-heading" data-toggle="collapse"
                    href="#starlark-practices" aria-expanded="false"
                    aria-controls="starlark-practices">
                  Best Practices<span class="caret"></span>
                </a>
                <ul class="collapse sidebar-nav sidebar-submenu" id="starlark-practices">
                  <li><a href="/versions/master/skylark/bzl-style.html">.bzl Style Guide</a></li>
                  <li><a href="/versions/master/skylark/testing.html">Testing</a></li>
                  <li><a href="https://skydoc.bazel.build" target="_blank">Documenting Rules</a></li>
                  <li><a href="/versions/master/skylark/skylint.html">Linter</a></li>
                  <li><a href="/versions/master/skylark/performance.html">Optimizing Performance</a></li>
                  <li><a href="/versions/master/skylark/deploying.html">Deploying Rules</a></li>
                </ul>
              </li>

              <li><a href="https://github.com/bazelbuild/examples/tree/master/rules">Examples</a></li>
              <li><a href="/versions/master/skylark/lib/skylark-overview.html">API Reference</a></li>
              <li><a href="/versions/master/skylark/language.html">Starlark Language</a></li>
            </ul>
          </nav>
        </div>

        <div class="col-md-9">
          <a id="gh-edit" class="gh-edit default-hidden"><i class="fa fa-pencil" aria-hidden="true"></i> Edit</a>
          <script>
            var versionDocsURLRegex = /\/versions\/[\w\.]+\/(.*)/;
            var ghDocsBazeURL = 'https://github.com/bazelbuild/bazel/tree/master/site/docs/';
            var editButton = document.getElementById('gh-edit');
            // if there is an edit button and we are not in the Build Encyclopedia
            if (editButton
                && window.location.pathname.match(versionDocsURLRegex)
                && window.location.pathname.lastIndexOf('/be/') == -1
                && window.location.pathname.lastIndexOf('/skylark/lib/') == -1) {
              var docFile = window.location.pathname.match(versionDocsURLRegex)[1];
              // some pages are not using markdown :(
              if (docFile !== 'user-manual.html'
                  && docFile !== 'build-ref.html'
                  && docFile !== 'query.html'
                  && docFile !== 'test-encyclopedia.html') {
                docFile = docFile.replace('html', 'md');
              }
              editButton.href = ghDocsBazeURL + docFile;
              editButton.style.visibility = 'visible';
            }
          </script>

          <h1 id="introduction-to-bazel-building-an-android-app">Introduction to Bazel: Building an Android App</h1>

<p>In this tutorial, you will learn how to build a simple Android app using Bazel.</p>

<p>Bazel supports building Android apps using the <a href="https://docs.bazel.build/versions/master/be/android.html">Android
rules</a>.</p>

<p>This tutorial is intended for Windows, macOS and Linux users and does not
require experience with Bazel or Android app development. You do not need to
write any Android code in this tutorial.</p>

<h2 id="prerequisites">Prerequisites</h2>

<p>You will need to install the following software:</p>

<ul>
  <li><strong>Bazel.</strong> To install, follow the <a href="../install.html">installation instructions</a>.</li>
  <li><strong>Android Studio.</strong> To install, follow the steps to <a href="https://developer.android.com/sdk/index.html">download Android
Studio</a>.</li>
  <li>(Optional) <strong>Git.</strong> We will use <code class="highlighter-rouge">git</code> to download the Android app project.</li>
</ul>

<h2 id="getting-started">Getting started</h2>

<p>We will be using a basic Android app project in <a href="https://github.com/bazelbuild/examples">Bazel’s examples
repository</a>.</p>

<p>This app has a single button that prints a greeting when clicked.</p>

<p><img src="/assets/android_tutorial_app.png" alt="screenshot of tutorial app" width="700" /></p>

<p>Clone the repository with <code class="highlighter-rouge">git</code> (or <a href="https://github.com/bazelbuild/examples/archive/master.zip">download the ZIP file
directly</a>):</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone git@github.com:bazelbuild/examples.git bazel-examples
<span class="nb">cd </span>bazel-examples/android/tutorial
</code></pre></div></div>

<p>For the rest of the tutorial, you will be executing commands in this directory.</p>

<h2 id="review-the-source-files">Review the source files</h2>

<p>Let’s take a look at the source files for the app.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>.
├── README.html
└── src
    └── main
        ├── AndroidManifest.xml
        └── java
            └── com
                └── example
                    └── bazel
                        ├── AndroidManifest.xml
                        ├── Greeter.java
                        ├── MainActivity.java
                        └── res
                            ├── layout
                            │   └── activity_main.xml
                            └── values
                                ├── colors.xml
                                └── strings.xml
</code></pre></div></div>

<p>The key files and directories are:</p>

<table>
  <tbody>
    <tr>
      <td>Name</td>
      <td>Location</td>
    </tr>
    <tr>
      <td>Android manifest files</td>
      <td><code class="highlighter-rouge">src/main/AndroidManifest.xml</code> and <code class="highlighter-rouge">src/main/java/com/example/bazel/AndroidManifest.xml</code></td>
    </tr>
    <tr>
      <td>Android source files</td>
      <td><code class="highlighter-rouge">src/main/java/com/example/bazel/MainActivity.java</code> and <code class="highlighter-rouge">Greeter.java</code></td>
    </tr>
    <tr>
      <td>Resource file directory</td>
      <td><code class="highlighter-rouge">src/main/java/com/example/bazel/res/</code></td>
    </tr>
  </tbody>
</table>

<h2 id="initialize-the-projects-workspace">Initialize the project’s workspace</h2>

<p>A <a href="../build-ref.html#workspace">workspace</a> is a directory that contains the
source files for one or more software projects, and has a <code class="highlighter-rouge">WORKSPACE</code> file at
its root.</p>

<p>The <code class="highlighter-rouge">WORKSPACE</code> file may be empty or may contain references to <a href="../external.html">external
dependencies</a> required to build your project.</p>

<p>First, run the following command to create an empty <code class="highlighter-rouge">WORKSPACE</code> file:</p>

<table>
  <tbody>
    <tr>
      <td>Linux, macOS</td>
      <td><code class="highlighter-rouge">touch WORKSPACE</code></td>
    </tr>
    <tr>
      <td>Windows (Command Prompt)</td>
      <td><code class="highlighter-rouge">type nul &gt; WORKSPACE</code></td>
    </tr>
    <tr>
      <td>Windows (PowerShell)</td>
      <td><code class="highlighter-rouge">New-Item WORKSPACE -ItemType file</code></td>
    </tr>
  </tbody>
</table>

<h3 id="running-bazel">Running Bazel</h3>

<p>You can now check if Bazel is running correctly with the command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bazel info workspace
</code></pre></div></div>

<p>If Bazel prints the path of the current directory, you’re good to go! If the
<code class="highlighter-rouge">WORKSPACE</code> file does not exist, you may see an error message like:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ERROR: The 'info' command is only supported from within a workspace.
</code></pre></div></div>

<h2 id="integrate-with-the-android-sdk">Integrate with the Android SDK</h2>

<p>Bazel needs to run the Android SDK <a href="https://developer.android.com/tools/revisions/build-tools.html">build
tools</a> to build
the app. This means that you need to add some information to your <code class="highlighter-rouge">WORKSPACE</code>
file so that Bazel knows where to find them.</p>

<p>Add the following line to your <code class="highlighter-rouge">WORKSPACE</code> file:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">android_sdk_repository</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"androidsdk"</span><span class="p">)</span>
</code></pre></div></div>

<p>This will use the Android SDK at the path referenced by the <code class="highlighter-rouge">ANDROID_HOME</code>
environment variable, and automatically detect the highest API level and the
latest version of build tools installed within that location.</p>

<p>You can set the <code class="highlighter-rouge">ANDROID_HOME</code> variable to the location of the Android SDK. Find
the path to the installed SDK using Android Studio’s <a href="https://developer.android.com/studio/intro/update#sdk-manager">SDK
Manager</a>.</p>

<p>For example, as the default SDK path is in your home directory for Linux and
macOS, and <code class="highlighter-rouge">LOCALAPPDATA</code> for Windows, you can use the following commands to set
the <code class="highlighter-rouge">ANDROID_HOME</code> variable:</p>

<table>
  <tbody>
    <tr>
      <td>Linux, macOS</td>
      <td><code class="highlighter-rouge">export ANDROID_HOME=$HOME/Android/Sdk/</code></td>
    </tr>
    <tr>
      <td>Windows (Command Prompt)</td>
      <td><code class="highlighter-rouge">set ANDROID_HOME=%LOCALAPPDATA%\Android\Sdk</code></td>
    </tr>
    <tr>
      <td>Windows (PowerShell)</td>
      <td><code class="highlighter-rouge">$env:ANDROID_HOME="$env:LOCALAPPDATA\Android\Sdk"</code></td>
    </tr>
  </tbody>
</table>

<p>The above commands set the variable only for the current shell session. To make
them permanent, run the following commands:</p>

<table>
  <tbody>
    <tr>
      <td>Linux, macOS</td>
      <td><code class="highlighter-rouge">echo "export ANDROID_HOME=$HOME/Android/Sdk/" &gt;&gt; ~/.bashrc</code></td>
    </tr>
    <tr>
      <td>Windows (Command Prompt)</td>
      <td><code class="highlighter-rouge">setx ANDROID_HOME "%LOCALAPPDATA%\Android\Sdk"</code></td>
    </tr>
    <tr>
      <td>Windows (PowerShell)</td>
      <td><code class="highlighter-rouge">[System.Environment]::SetEnvironmentVariable('ANDROID_HOME', "$env:LOCALAPPDATA\Android\Sdk", [System.EnvironmentVariableTarget]::User)</code></td>
    </tr>
  </tbody>
</table>

<p>You can also explicitly specify the absolute path of the Android SDK,
the API level, and the version of build tools to use by including the <code class="highlighter-rouge">path</code>,
<code class="highlighter-rouge">api_level</code>, and <code class="highlighter-rouge">build_tools_version</code> attributes. If <code class="highlighter-rouge">api_level</code> and
<code class="highlighter-rouge">build_tools_version</code> are not specified, the <code class="highlighter-rouge">android_sdk_repository</code> rule will
use the respective latest version available in the SDK. You can specify any
combination of these attributes, as long as they are present in the SDK, for
example:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">android_sdk_repository</span><span class="p">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">"androidsdk"</span><span class="p">,</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">"/path/to/Android/sdk"</span><span class="p">,</span>
    <span class="n">api_level</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span>
    <span class="n">build_tools_version</span> <span class="o">=</span> <span class="s">"26.0.1"</span>
<span class="p">)</span>
</code></pre></div></div>

<p>On Windows, note that the <code class="highlighter-rouge">path</code> attribute must use the mixed-style path, that
is, a Windows path with forward slashes:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">android_sdk_repository</span><span class="p">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">"androidsdk"</span><span class="p">,</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">"c:/path/to/Android/sdk"</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div></div>

<p><strong>Optional:</strong> If you want to compile native code into your Android app, you
also need to download the <a href="https://developer.android.com/ndk/downloads/index.html">Android
NDK</a>
and tell Bazel where to find it by adding the following line to your <code class="highlighter-rouge">WORKSPACE</code> file:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">android_ndk_repository</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"androidndk"</span><span class="p">)</span>
</code></pre></div></div>

<p>Similar to <code class="highlighter-rouge">android_sdk_repository</code>, the path to the Android NDK is inferred
from the <code class="highlighter-rouge">ANDROID_NDK_HOME</code> environment variable by default. The path can also
be explicitly specified with a <code class="highlighter-rouge">path</code> attribute on <code class="highlighter-rouge">android_ndk_repository</code>.</p>

<p>For more information, read <a href="https://docs.bazel.build/versions/master/android-ndk.html">Using the Android Native Development Kit with
Bazel</a>.</p>

<p><code class="highlighter-rouge">api_level</code> is the version of the Android API that the SDK and NDK
target - for example, 23 for Android 6.0 and 25 for Android 7.1. If not
explicitly set, <code class="highlighter-rouge">api_level</code> defaults to the highest available API level for
<code class="highlighter-rouge">android_sdk_repository</code> and <code class="highlighter-rouge">android_ndk_repository</code>.</p>

<p>It’s not necessary to set the API levels to the same value for the SDK and NDK.
<a href="https://developer.android.com/ndk/guides/stable_apis.html">This page</a> contains
a map from Android releases to NDK-supported API levels.</p>

<h2 id="create-a-build-file">Create a BUILD file</h2>

<p>A <a href="../build-ref.html#BUILD_files"><code class="highlighter-rouge">BUILD</code> file</a> describes the relationship
between a set of build outputs, like compiled Android resources from <code class="highlighter-rouge">aapt</code> or
class files from <code class="highlighter-rouge">javac</code>, and their dependencies. These dependencies may be
source files (Java, C++) in your workspace or other build outputs. <code class="highlighter-rouge">BUILD</code> files
are written in a language called <strong>Starlark</strong>.</p>

<p><code class="highlighter-rouge">BUILD</code> files are part of a concept in Bazel known as the <em>package hierarchy</em>.
The package hierarchy is a logical structure that overlays the directory
structure in your workspace. Each <a href="../build-ref.html#packages">package</a> is a
directory (and its subdirectories) that contains a related set of source files
and a <code class="highlighter-rouge">BUILD</code> file. The package also includes any subdirectories, excluding
those that contain their own <code class="highlighter-rouge">BUILD</code> file. The <em>package name</em> is the path to the
<code class="highlighter-rouge">BUILD</code> file relative to the <code class="highlighter-rouge">WORKSPACE</code>.</p>

<p>Note that Bazel’s package hierarchy is conceptually different from the Java
package hierarchy of your Android App directory where the <code class="highlighter-rouge">BUILD</code> file is
located. , although the directories may be organized identically.</p>

<p>For the simple Android app in this tutorial, the source files in <code class="highlighter-rouge">src/main/</code>
comprise a single Bazel package. A more complex project may have many nested
packages.</p>

<h3 id="add-an-android_library-rule">Add an android_library rule</h3>

<p>A <code class="highlighter-rouge">BUILD</code> file contains several different types of declarations for Bazel. The
most important type is the <a href="../build-ref.html#funcs">build rule</a>, which tells
Bazel how to build an intermediate or final software output from a set of source
files or other dependencies.</p>

<p>Bazel provides two build rules, <code class="highlighter-rouge">android_library</code> and <code class="highlighter-rouge">android_binary</code>, that you
can use to build an Android app. For this tutorial, you’ll first use the
<a href="../be/android.html#android_library"><code class="highlighter-rouge">android_library</code></a> rule to tell Bazel to
build an <a href="http://developer.android.com/tools/projects/index.html#LibraryProjects">Android library
module</a>
from the app source code and resource files. You’ll then use the
<code class="highlighter-rouge">android_binary</code> rule to tell Bazel how to build the Android application package.</p>

<p>Create a new <code class="highlighter-rouge">BUILD</code> file in the <code class="highlighter-rouge">src/main/java/com/example/bazel</code> directory,
and declare a new <code class="highlighter-rouge">android_library</code> target:</p>

<p><code class="highlighter-rouge">src/main/java/com/example/bazel/BUILD</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">package</span><span class="p">(</span>
    <span class="n">default_visibility</span> <span class="o">=</span> <span class="p">[</span><span class="s">"//src:__subpackages__"</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">android_library</span><span class="p">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">"greeter_activity"</span><span class="p">,</span>
    <span class="n">srcs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s">"Greeter.java"</span><span class="p">,</span>
        <span class="s">"MainActivity.java"</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">manifest</span> <span class="o">=</span> <span class="s">"AndroidManifest.xml"</span><span class="p">,</span>
    <span class="n">resource_files</span> <span class="o">=</span> <span class="n">glob</span><span class="p">([</span><span class="s">"res/**"</span><span class="p">]),</span>
<span class="p">)</span>
</code></pre></div></div>

<p>The <code class="highlighter-rouge">android_library</code> build rule contains a set of attributes that specify the
information that Bazel needs to build a library module from the source files.
Note also that the name of the rule is <code class="highlighter-rouge">greeter_activity</code>. You’ll reference the
rule using this name as a dependency in the <code class="highlighter-rouge">android_binary</code> rule.</p>

<h3 id="add-an-android_binary-rule">Add an android_binary rule</h3>

<p>The <a href="../be/android.html#android_binary"><code class="highlighter-rouge">android_binary</code></a> rule builds
the Android application package (<code class="highlighter-rouge">.apk</code> file) for your app.</p>

<p>Create a new <code class="highlighter-rouge">BUILD</code> file in the <code class="highlighter-rouge">src/main/</code> directory,
and declare a new <code class="highlighter-rouge">android_binary</code> target:</p>

<p><code class="highlighter-rouge">src/main/BUILD</code>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">android_binary</span><span class="p">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">"app"</span><span class="p">,</span>
    <span class="n">manifest</span> <span class="o">=</span> <span class="s">"AndroidManifest.xml"</span><span class="p">,</span>
    <span class="n">deps</span> <span class="o">=</span> <span class="p">[</span><span class="s">"//src/main/java/com/example/bazel:greeter_activity"</span><span class="p">],</span>
<span class="p">)</span>
</code></pre></div></div>

<p>Here, the <code class="highlighter-rouge">deps</code> attribute references the output of the <code class="highlighter-rouge">greeter_activity</code> rule
you added to the <code class="highlighter-rouge">BUILD</code> file above. This means that when Bazel builds the
output of this rule it checks first to see if the output of the
<code class="highlighter-rouge">greeter_activity</code> library rule has been built and is up-to-date. If not, Bazel
builds it and then uses that output to build the application package file.</p>

<p>Now, save and close the file.</p>

<h2 id="build-the-app">Build the app</h2>

<p>Let’s try building the app! Run the following command to build the
<code class="highlighter-rouge">android_binary</code> target:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bazel build //src/main:app
</code></pre></div></div>

<p>The <a href="../user-manual.html#build"><code class="highlighter-rouge">build</code></a> subcommand instructs Bazel to build the
target that follows. The target is specified as the name of a build rule inside
a <code class="highlighter-rouge">BUILD</code> file, with along with the package path relative to your workspace
directory. For this example, the target is <code class="highlighter-rouge">app</code> and the package path is
<code class="highlighter-rouge">//src/main/</code>.</p>

<p>Note that you can sometimes omit the package path or target name, depending on
your current working directory at the command line and the name of the target.
See <a href="../build-ref.html#labels">Labels</a> in the <em>Bazel Concepts and Terminology</em>
page for more information about target labels and paths.</p>

<p>Bazel will start to build the sample app. During the build process, its output
will appear similar to the following:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>INFO: Analysed target //src/main:app <span class="o">(</span>0 packages loaded, 0 targets configured<span class="o">)</span><span class="nb">.</span>
INFO: Found 1 target...
Target //src/main:app up-to-date:
  bazel-bin/src/main/app_deploy.jar
  bazel-bin/src/main/app_unsigned.apk
  bazel-bin/src/main/app.apk
</code></pre></div></div>

<h2 id="locate-the-build-outputs">Locate the build outputs</h2>

<p>Bazel puts the outputs of both intermediate and final build operations in a set
of per-user, per-workspace output directories. These directories are symlinked
from the following locations at the top-level of the project directory, where
the <code class="highlighter-rouge">WORKSPACE</code> is:</p>

<ul>
  <li><code class="highlighter-rouge">bazel-bin</code> stores binary executables and other runnable build outputs</li>
  <li><code class="highlighter-rouge">bazel-genfiles</code> stores intermediary source files that are generated by
 Bazel rules</li>
  <li><code class="highlighter-rouge">bazel-out</code> stores other types of build outputs</li>
</ul>

<p>Bazel stores the Android <code class="highlighter-rouge">.apk</code> file generated using the <code class="highlighter-rouge">android_binary</code> rule
in the <code class="highlighter-rouge">bazel-bin/src/main</code> directory, where the subdirectory name <code class="highlighter-rouge">src/main</code> is
derived from the name of the Bazel package.</p>

<p>At a command prompt, list the contents of this directory and find the <code class="highlighter-rouge">app.apk</code>
file:</p>

<table>
  <tbody>
    <tr>
      <td>Linux, macOS</td>
      <td><code class="highlighter-rouge">ls bazel-bin/src/main</code></td>
    </tr>
    <tr>
      <td>Windows (Command Prompt)</td>
      <td><code class="highlighter-rouge">dir bazel-bin\src\main</code></td>
    </tr>
    <tr>
      <td>Windows (PowerShell)</td>
      <td><code class="highlighter-rouge">ls bazel-bin\src\main</code></td>
    </tr>
  </tbody>
</table>

<h2 id="run-the-app">Run the app</h2>

<p>You can now deploy the app to a connected Android device or emulator from the
command line using the <a href="../user-manual.html#mobile-install"><code class="highlighter-rouge">bazel
mobile-install</code></a> command. This command uses
the Android Debug Bridge (<code class="highlighter-rouge">adb</code>) to communicate with the device. You must set up
your device to use <code class="highlighter-rouge">adb</code> following the instructions in <a href="http://developer.android.com/tools/help/adb.html">Android Debug
Bridge</a> before deployment. You
can also choose to install the app on the Android emulator included in Android
Studio. Make sure the emulator is running before executing the command below.</p>

<p>Enter the following:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bazel mobile-install //src/main:app
</code></pre></div></div>

<p>Next, find and launch the “Bazel Tutorial App”, which looks as follows:</p>

<p><img src="/assets/android_tutorial_before.png" alt="screenshot of tutorial app" width="500" /></p>

<p><strong>Congratulations! You have just installed your first Bazel-built Android app.</strong></p>

<p>Note that the <code class="highlighter-rouge">mobile-install</code> subcommand also supports the
<a href="../user-manual.html#mobile-install"><code class="highlighter-rouge">--incremental</code></a> flag that can be used to
deploy only those parts of the app that have changed since the last deployment.</p>

<p>It also supports the <code class="highlighter-rouge">--start_app</code> flag to start the app immediately upon
installing it.</p>

<h2 id="review-your-work">Review your work</h2>

<p>In this tutorial, you used Bazel to build an Android app. To accomplish that,
you:</p>

<ul>
  <li>Set up your environment by installing Bazel and Android Studio, and
downloading the sample project.</li>
  <li>Set up a Bazel <a href="workspace.html">workspace</a> that contains the source code
for the app and a <code class="highlighter-rouge">WORKSPACE</code> file that identifies the top level of the
workspace directory.</li>
  <li>Updated the <code class="highlighter-rouge">WORKSPACE</code> file to contain references to the required
external dependencies, like the Android SDK.</li>
  <li>Created a <code class="highlighter-rouge">BUILD</code> file.</li>
  <li>Built the app with Bazel.</li>
  <li>Deployed and ran the app on an Android emulator or physical device.</li>
</ul>

<h2 id="further-reading">Further reading</h2>

<p>You now know the basics of building an Android project with Bazel. Here are some
other pages to check out:</p>

<ul>
  <li>More information on <a href="mobile-install.html">mobile-install</a></li>
  <li>Testing your app with <a href="android-instrumentation-test.html">Android instrumentation tests</a></li>
  <li>Integrating C and C++ code into your Android app with the <a href="android-ndk.html">NDK</a></li>
</ul>

<p>Happy building!</p>

        </div>
      </div>
    </div>

    <!-- Satisfaction Survey -->
    <script async="" defer="" src="//survey.g.doubleclick.net/async_survey?site=oohdpic4fyfp3jcnym6aqkdf3e"></script>

        <footer class="footer">
      <div class="container">
  <div class="row">
    <div class="col-sm-4 col-md-2">
      <p>About</p>
      <ul class="list-unstyled">
        <li><a href="https://github.com/bazelbuild/bazel/wiki/Bazel-Users">Who's Using Bazel?</a></li>
        <li><a href="https://www.bazel.build/roadmap.html">Roadmap</a></li>
        <li><a href="https://www.bazel.build/contributing.html">Contribute</a></li>
        <li><a href="https://www.bazel.build/governance.html">Governance Plan</a></li>
        <li><a href="https://policies.google.com/privacy">Privacy Policy</a></li>
      </ul>
    </div>
    <div class="col-sm-4 col-md-2">
      <p>Support</p>
      <ul class="list-unstyled">
        <li><a href="http://stackoverflow.com/questions/tagged/bazel">Stack Overflow</a></li>
        <li><a href="https://github.com/bazelbuild/bazel/issues">Issue Tracker</a></li>
        <li><a href="/">Documentation</a></li>
        <li><a href="https://www.bazel.build/faq.html">FAQ</a></li>
        <li><a href="https://www.bazel.build/support.html">Support Policy</a></li>
      </ul>
    </div>
    <div class="col-sm-4 col-md-2">
      <p>Stay Connected</p>
      <ul class="list-unstyled">
        <li><a href="https://twitter.com/bazelbuild">Twitter</a></li>
        <li><a href="https://blog.bazel.build">Blog</a></li>
        <li><a href="https://github.com/bazelbuild/bazel">GitHub</a></li>
        <li><a href="https://groups.google.com/forum/#!forum/bazel-discuss">Discussion group</a></li>
      </ul>
    </div>
  </div>
  <div class="row">
    <div class="col-lg-12">
      <p class="text-muted">&copy; 2018 Google</p>
    </div>
  </div>
</div>

    </footer>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="/assets/js/bootstrap.min.js"></script>

    <!-- Anchor JS -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.2.0/anchor.min.js"></script>
    <script>
      // Automatically add anchors and links to all header elements that don't already have them.
      anchors.add();
    </script>

    <script>
      var shiftWindow = function() {
        if (location.hash.length !== 0) {
          window.scrollBy(0, -50);
        }
      };
      window.addEventListener("hashchange", shiftWindow);

      var highlightCurrentSidebarNav = function() {
        var href = location.pathname;
        var item = $('#sidebar-nav [href$="' + href + '"]');
        if (item) {
          var li = item.parent();
          li.addClass("active");

          if (li.parent() && li.parent().is("ul")) {
            do {
              var ul = li.parent();
              if (ul.hasClass("collapse")) {
                ul.collapse("show");
              }
              li = ul.parent();
            } while (li && li.is("li"));
          }
        }
      };

      $(document).ready(function() {
        // Scroll to anchor of location hash, adjusted for fixed navbar.
        window.setTimeout(function() {
          shiftWindow();
        }, 1);

        // Flip the caret when submenu toggles are clicked.
        $(".sidebar-submenu").on("show.bs.collapse", function() {
          var toggle = $('[href$="#' + $(this).attr('id') + '"]');
          if (toggle) {
            toggle.addClass("dropup");
          }
        });
        $(".sidebar-submenu").on("hide.bs.collapse", function() {
          var toggle = $('[href$="#' + $(this).attr('id') + '"]');
          if (toggle) {
            toggle.removeClass("dropup");
          }
        });

        // Highlight the current page on the sidebar nav.
        highlightCurrentSidebarNav();
      });
    </script>

    <!-- Google Analytics tracking code -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-61082125-1', 'auto');
      ga('send', 'pageview');
    </script>

  </body>
</html>

